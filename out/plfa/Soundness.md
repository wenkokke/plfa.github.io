---
src       : src/plfa/Soundness.lagda
src       : src/plfa/Soundness.lagda
src       : src/plfa/Soundness.lagda
src       : src/plfa/Soundness.lagda
src       : src/plfa/Soundness.lagda
title     : "Soundness: of reduction with respect to denotational semantics"
layout    : page
prev      : /Compositional/
permalink : /Soundness/
next      : /Adequacy/
---

<pre class="Agda">{% raw %}<a id="192" class="Keyword">module</a> <a id="199" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}" class="Module">plfa.Soundness</a> <a id="214" class="Keyword">where</a>{% endraw %}</pre>

## Imports

<pre class="Agda">{% raw %}<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}" class="Module">plfa.Untyped</a>
  <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a id="291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2980" class="Datatype">Context</a><a id="298" class="Symbol">;</a> <a id="300" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">_,_</a><a id="303" class="Symbol">;</a> <a id="305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">_∋_</a><a id="308" class="Symbol">;</a> <a id="310" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">_⊢_</a><a id="313" class="Symbol">;</a> <a id="315" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="316" class="Symbol">;</a> <a id="318" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a><a id="319" class="Symbol">;</a> <a id="321" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S_</a><a id="323" class="Symbol">;</a> <a id="325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`_</a><a id="327" class="Symbol">;</a> <a id="329" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ_</a><a id="331" class="Symbol">;</a> <a id="333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">_·_</a><a id="336" class="Symbol">;</a>
         <a id="347" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6931" class="Function">subst</a><a id="352" class="Symbol">;</a> <a id="354" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">_[_]</a><a id="358" class="Symbol">;</a> <a id="360" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7359" class="Function">subst-zero</a><a id="370" class="Symbol">;</a> <a id="372" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#5845" class="Function">ext</a><a id="375" class="Symbol">;</a> <a id="377" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6171" class="Function">rename</a><a id="383" class="Symbol">;</a> <a id="385" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6623" class="Function">exts</a><a id="389" class="Symbol">)</a>
<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}" class="Module">plfa.LambdaReduction</a>
  <a id="426" class="Keyword">using</a> <a id="432" class="Symbol">(</a><a id="433" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#386" class="Datatype Operator">_—→_</a><a id="437" class="Symbol">;</a> <a id="439" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#436" class="InductiveConstructor">ξ₁</a><a id="441" class="Symbol">;</a> <a id="443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#526" class="InductiveConstructor">ξ₂</a><a id="445" class="Symbol">;</a> <a id="447" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#616" class="InductiveConstructor">β</a><a id="448" class="Symbol">;</a> <a id="450" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#724" class="InductiveConstructor">ζ</a><a id="451" class="Symbol">;</a> <a id="453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#894" class="Datatype Operator">_—↠_</a><a id="457" class="Symbol">;</a> <a id="459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#1001" class="InductiveConstructor Operator">_—→⟨_⟩_</a><a id="466" class="Symbol">;</a> <a id="468" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#944" class="InductiveConstructor Operator">_[]</a><a id="471" class="Symbol">)</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}" class="Module">plfa.Substitution</a> <a id="503" class="Keyword">using</a> <a id="509" class="Symbol">(</a><a id="510" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2259" class="Function">Rename</a><a id="516" class="Symbol">;</a> <a id="518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a><a id="523" class="Symbol">)</a>  
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}" class="Module">plfa.Denotational</a>
  <a id="559" class="Keyword">using</a> <a id="565" class="Symbol">(</a><a id="566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#3989" class="Datatype">Value</a><a id="571" class="Symbol">;</a> <a id="573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4009" class="InductiveConstructor">⊥</a><a id="574" class="Symbol">;</a> <a id="576" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a><a id="579" class="Symbol">;</a> <a id="581" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">_⊢_↓_</a><a id="586" class="Symbol">;</a> <a id="588" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">_`,_</a><a id="592" class="Symbol">;</a> <a id="594" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4360" class="Datatype Operator">_⊑_</a><a id="597" class="Symbol">;</a> <a id="599" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">_`⊑_</a><a id="603" class="Symbol">;</a> <a id="605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8468" class="Function">`⊥</a><a id="607" class="Symbol">;</a> <a id="609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8497" class="Function Operator">_`⊔_</a><a id="613" class="Symbol">;</a> <a id="615" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7649" class="Function">init</a><a id="619" class="Symbol">;</a> <a id="621" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7704" class="Function">last</a><a id="625" class="Symbol">;</a> <a id="627" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7753" class="Function">init-last</a><a id="636" class="Symbol">;</a>
         <a id="647" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5530" class="Function">Refl⊑</a><a id="652" class="Symbol">;</a> <a id="654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4657" class="InductiveConstructor">Trans⊑</a><a id="660" class="Symbol">;</a> <a id="662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8767" class="Function">`Refl⊑</a><a id="668" class="Symbol">;</a> <a id="670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a><a id="674" class="Symbol">;</a> <a id="676" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8835" class="Function">EnvConjR1⊑</a><a id="686" class="Symbol">;</a> <a id="688" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8932" class="Function">EnvConjR2⊑</a><a id="698" class="Symbol">;</a> <a id="700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26910" class="Function">up-env</a><a id="706" class="Symbol">;</a>
         <a id="717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a><a id="720" class="Symbol">;</a> <a id="722" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a><a id="728" class="Symbol">;</a> <a id="730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a><a id="737" class="Symbol">;</a> <a id="739" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a><a id="746" class="Symbol">;</a> <a id="748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a><a id="755" class="Symbol">;</a> <a id="757" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a><a id="760" class="Symbol">;</a>
         <a id="771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#23693" class="Function">rename-pres</a><a id="782" class="Symbol">;</a> <a id="784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26128" class="Function">var-id</a><a id="790" class="Symbol">;</a> <a id="792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#17987" class="Function">ℰ</a><a id="793" class="Symbol">;</a> <a id="795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18185" class="Function Operator">_≃_</a><a id="798" class="Symbol">;</a> <a id="800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18606" class="Function">≃-trans</a><a id="807" class="Symbol">)</a>
<a id="809" class="Keyword">open</a> <a id="814" class="Keyword">import</a> <a id="821" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}" class="Module">plfa.Compositional</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3272" class="Function">lambda-inversion</a><a id="863" class="Symbol">;</a> <a id="865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9327" class="Function">var-inv</a><a id="872" class="Symbol">)</a>

<a id="875" class="Keyword">open</a> <a id="880" class="Keyword">import</a> <a id="887" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
  <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a><a id="934" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="937" class="Symbol">;</a> <a id="939" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#660" class="Function Operator">_≢_</a><a id="942" class="Symbol">;</a> <a id="944" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="948" class="Symbol">;</a> <a id="950" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a><a id="953" class="Symbol">;</a> <a id="955" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1170" class="Function">cong</a><a id="959" class="Symbol">;</a> <a id="961" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1408" class="Function">cong₂</a><a id="966" class="Symbol">;</a> <a id="968" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.html#1274" class="Function">cong-app</a><a id="976" class="Symbol">)</a>
<a id="978" class="Keyword">open</a> <a id="983" class="Keyword">import</a> <a id="990" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html" class="Module">Data.Product</a> <a id="1003" class="Keyword">using</a> <a id="1009" class="Symbol">(</a><a id="1010" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#1353" class="Function Operator">_×_</a><a id="1013" class="Symbol">;</a> <a id="1015" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#69" class="Record">Σ</a><a id="1016" class="Symbol">;</a> <a id="1018" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">Σ-syntax</a><a id="1026" class="Symbol">;</a> <a id="1028" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#881" class="Function">∃</a><a id="1029" class="Symbol">;</a> <a id="1031" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#942" class="Function">∃-syntax</a><a id="1039" class="Symbol">;</a> <a id="1041" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="1046" class="Symbol">;</a> <a id="1048" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#167" class="Field">proj₂</a><a id="1053" class="Symbol">)</a>
  <a id="1057" class="Keyword">renaming</a> <a id="1066" class="Symbol">(</a><a id="1067" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a> <a id="1071" class="Symbol">to</a> <a id="1074" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨_,_⟩</a><a id="1079" class="Symbol">)</a>
<a id="1081" class="Keyword">open</a> <a id="1086" class="Keyword">import</a> <a id="1093" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="1108" class="Keyword">using</a> <a id="1114" class="Symbol">(</a><a id="1115" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Primitive.html#611" class="Primitive">lzero</a><a id="1120" class="Symbol">)</a>
<a id="1122" class="Keyword">open</a> <a id="1127" class="Keyword">import</a> <a id="1134" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1151" class="Keyword">using</a> <a id="1157" class="Symbol">(</a><a id="1158" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#464" class="Function Operator">¬_</a><a id="1160" class="Symbol">)</a>
<a id="1162" class="Keyword">open</a> <a id="1167" class="Keyword">import</a> <a id="1174" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1200" class="Keyword">using</a> <a id="1206" class="Symbol">(</a><a id="1207" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.Negation.html#560" class="Function">contradiction</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="https://agda.github.io/agda-stdlib/v0.17/Data.Empty.html" class="Module">Data.Empty</a> <a id="1245" class="Keyword">using</a> <a id="1251" class="Symbol">(</a><a id="1252" href="https://agda.github.io/agda-stdlib/v0.17/Data.Empty.html#360" class="Function">⊥-elim</a><a id="1258" class="Symbol">)</a>
<a id="1260" class="Keyword">open</a> <a id="1265" class="Keyword">import</a> <a id="1272" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1289" class="Keyword">using</a> <a id="1295" class="Symbol">(</a><a id="1296" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#534" class="Datatype">Dec</a><a id="1299" class="Symbol">;</a> <a id="1301" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a><a id="1304" class="Symbol">;</a> <a id="1306" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a><a id="1308" class="Symbol">)</a>
<a id="1310" class="Keyword">open</a> <a id="1315" class="Keyword">import</a> <a id="1322" href="https://agda.github.io/agda-stdlib/v0.17/Function.html" class="Module">Function</a> <a id="1331" class="Keyword">using</a> <a id="1337" class="Symbol">(</a><a id="1338" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">_∘_</a><a id="1341" class="Symbol">)</a>
<a id="1343" class="Comment">-- open import plfa.Isomorphism using (extensionality)  -- causes a bug!</a>{% endraw %}</pre>


In this chapter we prove that the reduction semantics is sound with
respect to the denotational semantics, i.e., for any term L

    L —↠ ƛ N  implies  ℰ L ≃ ℰ (ƛ N)

The proof is by induction on the reduction sequence, so the main lemma
concerns a single reduction step. We prove that if any term `M` steps
to a term `N`, then `M` and `N` are denotationally equal. We shall
prove each direction of this if-and-only-if separately. One direction
will look just like a type preservation proof. The other direction is
like proving type preservation for reduction going in reverse.  Recall
that type preservation is sometimes called subject
reduction. Preservation in reverse is a well-known property and is
called _subject expansion_. It is also well-known that subject
expansion is false for most typed lambda calculi!


## Forward reduction preserves denotations

The proof of preservation in this section mixes techniques from
previous chapters. Like the proof of preservation for the STLC, we are
preserving a relation defined separately from the syntax, in contrast
to the inherently typed terms. On the other hand, we are using de
Bruijn indices for variables.

The outline of the proof remains the same in that we must prove lemmas
concerning all of the auxiliary functions used in the reduction
relation: substitution, renaming, and extension.


### Simultaneous substitution preserves denotations

Our next goal is to prove that simultaneous substitution preserves
meaning.  That is, if `M` results in `v` in environment `γ`, then applying a
substitution `σ` to `M` gives us a program that also results in `v`, but in
an environment `δ` in which, for every variable `x`, `σ x` results in the
same value as the one for `x` in the original environment `γ`.
We write `δ ⊢ σ ↓ γ` for this condition.

<pre class="Agda">{% raw %}<a id="3245" class="Keyword">infix</a> <a id="3251" class="Number">3</a> <a id="3253" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">_`⊢_↓_</a>
<a id="_`⊢_↓_"></a><a id="3260" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">_`⊢_↓_</a> <a id="3267" class="Symbol">:</a> <a id="3269" class="Symbol">∀{</a><a id="3271" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3271" class="Bound">Δ</a> <a id="3273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3273" class="Bound">Γ</a><a id="3274" class="Symbol">}</a> <a id="3276" class="Symbol">→</a> <a id="3278" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="3282" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3271" class="Bound">Δ</a> <a id="3284" class="Symbol">→</a> <a id="3286" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="3292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3273" class="Bound">Γ</a> <a id="3294" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3271" class="Bound">Δ</a> <a id="3296" class="Symbol">→</a> <a id="3298" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="3302" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3273" class="Bound">Γ</a> <a id="3304" class="Symbol">→</a> <a id="3306" class="PrimitiveType">Set</a>
<a id="3310" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">_`⊢_↓_</a> <a id="3317" class="Symbol">{</a><a id="3318" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3318" class="Bound">Δ</a><a id="3319" class="Symbol">}{</a><a id="3321" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3321" class="Bound">Γ</a><a id="3322" class="Symbol">}</a> <a id="3324" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3324" class="Bound">δ</a> <a id="3326" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3326" class="Bound">σ</a> <a id="3328" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3328" class="Bound">γ</a> <a id="3330" class="Symbol">=</a> <a id="3332" class="Symbol">(∀</a> <a id="3335" class="Symbol">(</a><a id="3336" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3336" class="Bound">x</a> <a id="3338" class="Symbol">:</a> <a id="3340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3321" class="Bound">Γ</a> <a id="3342" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="3344" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="3345" class="Symbol">)</a> <a id="3347" class="Symbol">→</a> <a id="3349" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3324" class="Bound">δ</a> <a id="3351" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="3353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3326" class="Bound">σ</a> <a id="3355" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3336" class="Bound">x</a> <a id="3357" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="3359" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3328" class="Bound">γ</a> <a id="3361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3336" class="Bound">x</a><a id="3362" class="Symbol">)</a>{% endraw %}</pre>

As usual, to prepare for lambda abstraction, we prove an extension
lemma. It says that applying the `exts` function to a substitution
produces a new substitution that maps variables to terms that when
evaluated in `δ , v` produce the values in `γ , v`.

<pre class="Agda">{% raw %}<a id="subst-ext"></a><a id="3643" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3643" class="Function">subst-ext</a> <a id="3653" class="Symbol">:</a> <a id="3655" class="Symbol">∀</a> <a id="3657" class="Symbol">{</a><a id="3658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3658" class="Bound">Γ</a> <a id="3660" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3660" class="Bound">Δ</a> <a id="3662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3662" class="Bound">v</a><a id="3663" class="Symbol">}</a> <a id="3665" class="Symbol">{</a><a id="3666" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3666" class="Bound">γ</a> <a id="3668" class="Symbol">:</a> <a id="3670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="3674" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3658" class="Bound">Γ</a><a id="3675" class="Symbol">}</a> <a id="3677" class="Symbol">{</a><a id="3678" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3678" class="Bound">δ</a> <a id="3680" class="Symbol">:</a> <a id="3682" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="3686" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3660" class="Bound">Δ</a><a id="3687" class="Symbol">}</a>
  <a id="3691" class="Symbol">→</a> <a id="3693" class="Symbol">(</a><a id="3694" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3694" class="Bound">σ</a> <a id="3696" class="Symbol">:</a> <a id="3698" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="3704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3658" class="Bound">Γ</a> <a id="3706" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3660" class="Bound">Δ</a><a id="3707" class="Symbol">)</a>
  <a id="3711" class="Symbol">→</a> <a id="3713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3678" class="Bound">δ</a> <a id="3715" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="3718" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3694" class="Bound">σ</a> <a id="3720" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="3722" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3666" class="Bound">γ</a>
   <a id="3727" class="Comment">--------------------------</a>
  <a id="3756" class="Symbol">→</a> <a id="3758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3678" class="Bound">δ</a> <a id="3760" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="3763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3662" class="Bound">v</a> <a id="3765" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="3768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6623" class="Function">exts</a> <a id="3773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3694" class="Bound">σ</a> <a id="3775" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="3777" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3666" class="Bound">γ</a> <a id="3779" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="3782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3662" class="Bound">v</a>
<a id="3784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3643" class="Function">subst-ext</a> <a id="3794" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3794" class="Bound">σ</a> <a id="3796" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3796" class="Bound">d</a> <a id="3798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="3800" class="Symbol">=</a> <a id="3802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a>
<a id="3806" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3643" class="Function">subst-ext</a> <a id="3816" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3816" class="Bound">σ</a> <a id="3818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3818" class="Bound">d</a> <a id="3820" class="Symbol">(</a><a id="3821" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="3823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3823" class="Bound">x′</a><a id="3825" class="Symbol">)</a> <a id="3827" class="Symbol">=</a> <a id="3829" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#23693" class="Function">rename-pres</a> <a id="3841" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S_</a> <a id="3844" class="Symbol">(λ</a> <a id="3847" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3847" class="Bound">_</a> <a id="3849" class="Symbol">→</a> <a id="3851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5530" class="Function">Refl⊑</a><a id="3856" class="Symbol">)</a> <a id="3858" class="Symbol">(</a><a id="3859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3818" class="Bound">d</a> <a id="3861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3823" class="Bound">x′</a><a id="3863" class="Symbol">)</a>{% endraw %}</pre>

The proof is by cases on the de Bruijn index `x`.

* If it is `Z`, then we need to show that `δ , v ⊢ # 0 ↓ v`,
  which we have by rule `var`.

* If it is `S x′`,then we need to show that 
  `δ , v ⊢ rename S_ (σ x′) ↓ nth x′ γ`,
  which we obtain by the `rename-pres` lemma.

With the extension lemma in hand, the proof that simultaneous
substitution preserves meaning is straightforward.  Let's dive in!

<pre class="Agda">{% raw %}<a id="subst-pres"></a><a id="4297" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4308" class="Symbol">:</a> <a id="4310" class="Symbol">∀</a> <a id="4312" class="Symbol">{</a><a id="4313" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4313" class="Bound">Γ</a> <a id="4315" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4315" class="Bound">Δ</a> <a id="4317" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4317" class="Bound">v</a><a id="4318" class="Symbol">}</a> <a id="4320" class="Symbol">{</a><a id="4321" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4321" class="Bound">γ</a> <a id="4323" class="Symbol">:</a> <a id="4325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="4329" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4313" class="Bound">Γ</a><a id="4330" class="Symbol">}</a> <a id="4332" class="Symbol">{</a><a id="4333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4333" class="Bound">δ</a> <a id="4335" class="Symbol">:</a> <a id="4337" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="4341" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4315" class="Bound">Δ</a><a id="4342" class="Symbol">}</a> <a id="4344" class="Symbol">{</a><a id="4345" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4345" class="Bound">M</a> <a id="4347" class="Symbol">:</a> <a id="4349" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4313" class="Bound">Γ</a> <a id="4351" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="4353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="4354" class="Symbol">}</a>
  <a id="4358" class="Symbol">→</a> <a id="4360" class="Symbol">(</a><a id="4361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4361" class="Bound">σ</a> <a id="4363" class="Symbol">:</a> <a id="4365" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="4371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4313" class="Bound">Γ</a> <a id="4373" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4315" class="Bound">Δ</a><a id="4374" class="Symbol">)</a>
  <a id="4378" class="Symbol">→</a> <a id="4380" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4333" class="Bound">δ</a> <a id="4382" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="4385" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4361" class="Bound">σ</a> <a id="4387" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="4389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4321" class="Bound">γ</a>
  <a id="4393" class="Symbol">→</a> <a id="4395" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4321" class="Bound">γ</a> <a id="4397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="4399" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4345" class="Bound">M</a> <a id="4401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="4403" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4317" class="Bound">v</a>
    <a id="4409" class="Comment">------------------</a>
  <a id="4430" class="Symbol">→</a> <a id="4432" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4333" class="Bound">δ</a> <a id="4434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="4436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6931" class="Function">subst</a> <a id="4442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4361" class="Bound">σ</a> <a id="4444" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4345" class="Bound">M</a> <a id="4446" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="4448" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4317" class="Bound">v</a>
<a id="4450" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4461" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4461" class="Bound">σ</a> <a id="4463" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4463" class="Bound">s</a> <a id="4465" class="Symbol">(</a><a id="4466" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="4470" class="Symbol">{</a><a id="4471" class="Argument">x</a> <a id="4473" class="Symbol">=</a> <a id="4475" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4475" class="Bound">x</a><a id="4476" class="Symbol">})</a> <a id="4479" class="Symbol">=</a> <a id="4481" class="Symbol">(</a><a id="4482" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4463" class="Bound">s</a> <a id="4484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4475" class="Bound">x</a><a id="4485" class="Symbol">)</a>
<a id="4487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4498" class="Bound">σ</a> <a id="4500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4500" class="Bound">s</a> <a id="4502" class="Symbol">(</a><a id="4503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="4510" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4510" class="Bound">d₁</a> <a id="4513" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4513" class="Bound">d₂</a><a id="4515" class="Symbol">)</a> <a id="4517" class="Symbol">=</a>
  <a id="4521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="4528" class="Symbol">(</a><a id="4529" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4540" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4498" class="Bound">σ</a> <a id="4542" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4500" class="Bound">s</a> <a id="4544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4510" class="Bound">d₁</a><a id="4546" class="Symbol">)</a> <a id="4548" class="Symbol">(</a><a id="4549" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4560" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4498" class="Bound">σ</a> <a id="4562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4500" class="Bound">s</a> <a id="4564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4513" class="Bound">d₂</a><a id="4566" class="Symbol">)</a> 
<a id="4569" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4580" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4580" class="Bound">σ</a> <a id="4582" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4582" class="Bound">s</a> <a id="4584" class="Symbol">(</a><a id="4585" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="4593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4593" class="Bound">d</a><a id="4594" class="Symbol">)</a> <a id="4596" class="Symbol">=</a>
  <a id="4600" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="4608" class="Symbol">(</a><a id="4609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4620" class="Symbol">(λ</a> <a id="4623" class="Symbol">{</a><a id="4624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4624" class="Bound">A</a><a id="4625" class="Symbol">}</a> <a id="4627" class="Symbol">→</a> <a id="4629" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6623" class="Function">exts</a> <a id="4634" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4580" class="Bound">σ</a><a id="4635" class="Symbol">)</a> <a id="4637" class="Symbol">(</a><a id="4638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3643" class="Function">subst-ext</a> <a id="4648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4580" class="Bound">σ</a> <a id="4650" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4582" class="Bound">s</a><a id="4651" class="Symbol">)</a> <a id="4653" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4593" class="Bound">d</a><a id="4654" class="Symbol">)</a>
<a id="4656" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4667" class="Bound">σ</a> <a id="4669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4669" class="Bound">s</a> <a id="4671" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="4679" class="Symbol">=</a> <a id="4681" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>
<a id="4689" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4700" class="Bound">σ</a> <a id="4702" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4702" class="Bound">s</a> <a id="4704" class="Symbol">(</a><a id="4705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="4713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4713" class="Bound">d₁</a> <a id="4716" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4716" class="Bound">d₂</a><a id="4718" class="Symbol">)</a> <a id="4720" class="Symbol">=</a>
  <a id="4724" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="4732" class="Symbol">(</a><a id="4733" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4700" class="Bound">σ</a> <a id="4746" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4702" class="Bound">s</a> <a id="4748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4713" class="Bound">d₁</a><a id="4750" class="Symbol">)</a> <a id="4752" class="Symbol">(</a><a id="4753" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4764" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4700" class="Bound">σ</a> <a id="4766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4702" class="Bound">s</a> <a id="4768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4716" class="Bound">d₂</a><a id="4770" class="Symbol">)</a>
<a id="4772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4783" class="Bound">σ</a> <a id="4785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4785" class="Bound">s</a> <a id="4787" class="Symbol">(</a><a id="4788" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="4792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4792" class="Bound">d</a> <a id="4794" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4794" class="Bound">lt</a><a id="4796" class="Symbol">)</a> <a id="4798" class="Symbol">=</a> <a id="4800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="4804" class="Symbol">(</a><a id="4805" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="4816" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4783" class="Bound">σ</a> <a id="4818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4785" class="Bound">s</a> <a id="4820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4792" class="Bound">d</a><a id="4821" class="Symbol">)</a> <a id="4823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4794" class="Bound">lt</a>{% endraw %}</pre>

The proof is by induction on the semantics of `M`.  The two interesting
cases are for variables and lambda abstractions.

* For a variable `x`, we have that `v ⊑ nth x γ` and we need to show that
  `δ ⊢ σ x ↓ v`.  From the premise applied to `x`, we have that
  `δ ⊢ σ x ↓ nth x γ`, so we conclude by the `sub` rule.

* For a lambda abstraction, we must extend the substitution
  for the induction hypothesis. We apply the `subst-ext` lemma
  to show that the extended substitution maps variables to
  terms that result in the appropriate values.


### Single substitution preserves denotations

For β reduction, `(ƛ N) · M —→ N [ M ]`, we need to show that the
semantics is preserved when substituting `M` for de Bruijn index 0 in
term `N`. By inversion on the rules `↦-elim` and `↦-intro`,
we have that `γ , v ⊢ M ↓ w` and `γ ⊢ N ↓ v`.
So we need to show that `γ ⊢ M [ N ] ↓ w`, or equivalently,
that `γ ⊢ subst (subst-zero N) M ↓ w`.

<pre class="Agda">{% raw %}<a id="substitution"></a><a id="5789" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5789" class="Function">substitution</a> <a id="5802" class="Symbol">:</a> <a id="5804" class="Symbol">∀</a> <a id="5806" class="Symbol">{</a><a id="5807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5807" class="Bound">Γ</a><a id="5808" class="Symbol">}</a> <a id="5810" class="Symbol">{</a><a id="5811" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5811" class="Bound">γ</a> <a id="5813" class="Symbol">:</a> <a id="5815" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="5819" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5807" class="Bound">Γ</a><a id="5820" class="Symbol">}</a> <a id="5822" class="Symbol">{</a><a id="5823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5823" class="Bound">N</a> <a id="5825" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5825" class="Bound">M</a> <a id="5827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5827" class="Bound">v</a> <a id="5829" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5829" class="Bound">w</a><a id="5830" class="Symbol">}</a>
   <a id="5835" class="Symbol">→</a> <a id="5837" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5811" class="Bound">γ</a> <a id="5839" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="5842" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5827" class="Bound">v</a> <a id="5844" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="5846" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5823" class="Bound">N</a> <a id="5848" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="5850" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5829" class="Bound">w</a>
   <a id="5855" class="Symbol">→</a> <a id="5857" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5811" class="Bound">γ</a> <a id="5859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="5861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5825" class="Bound">M</a> <a id="5863" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="5865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5827" class="Bound">v</a>
     <a id="5872" class="Comment">---------------</a>
   <a id="5891" class="Symbol">→</a> <a id="5893" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5811" class="Bound">γ</a> <a id="5895" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="5897" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5823" class="Bound">N</a> <a id="5899" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">[</a> <a id="5901" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5825" class="Bound">M</a> <a id="5903" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">]</a> <a id="5905" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="5907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5829" class="Bound">w</a>   
<a id="5912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5789" class="Function">substitution</a><a id="5924" class="Symbol">{</a><a id="5925" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5925" class="Bound">Γ</a><a id="5926" class="Symbol">}{</a><a id="5928" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5928" class="Bound">γ</a><a id="5929" class="Symbol">}{</a><a id="5931" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5931" class="Bound">N</a><a id="5932" class="Symbol">}{</a><a id="5934" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5934" class="Bound">M</a><a id="5935" class="Symbol">}{</a><a id="5937" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5937" class="Bound">v</a><a id="5938" class="Symbol">}{</a><a id="5940" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5940" class="Bound">w</a><a id="5941" class="Symbol">}</a> <a id="5943" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5943" class="Bound">dn</a> <a id="5946" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5946" class="Bound">dm</a> <a id="5949" class="Symbol">=</a>
  <a id="5953" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#4297" class="Function">subst-pres</a> <a id="5964" class="Symbol">(</a><a id="5965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7359" class="Function">subst-zero</a> <a id="5976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5934" class="Bound">M</a><a id="5977" class="Symbol">)</a> <a id="5979" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6001" class="Function">sub-z-ok</a> <a id="5988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5943" class="Bound">dn</a>
  <a id="5993" class="Keyword">where</a>
  <a id="6001" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6001" class="Function">sub-z-ok</a> <a id="6010" class="Symbol">:</a> <a id="6012" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5928" class="Bound">γ</a> <a id="6014" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="6017" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7359" class="Function">subst-zero</a> <a id="6028" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5934" class="Bound">M</a> <a id="6030" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="6032" class="Symbol">(</a><a id="6033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5928" class="Bound">γ</a> <a id="6035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="6038" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5937" class="Bound">v</a><a id="6039" class="Symbol">)</a>
  <a id="6043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6001" class="Function">sub-z-ok</a> <a id="6052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="6054" class="Symbol">=</a> <a id="6056" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5946" class="Bound">dm</a>
  <a id="6061" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6001" class="Function">sub-z-ok</a> <a id="6070" class="Symbol">(</a><a id="6071" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="6073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6073" class="Bound">x</a><a id="6074" class="Symbol">)</a> <a id="6076" class="Symbol">=</a> <a id="6078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a>{% endraw %}</pre>

This result is a corollary of the lemma for simultaneous substitution.
To use the lemma, we just need to show that `subst-zero M` maps
variables to terms that produces the same values as those in `γ , v`.
Let `y` be an arbitrary variable (de Bruijn index).

* If it is `Z`, then `(subst-zero M) y = M` and `nth y (γ , v) = v`.
  By the premise we conclude that `γ ⊢ M ↓ v`.

* If it is `S x`, then `(subst-zero M) (S x) = x` and
  `nth (S x) (γ , v) = nth x γ`.  So we conclude that
  `γ ⊢ x ↓ nth x γ` by rule `var`.


### Reduction preserves denotations

With the substitution lemma in hand, it is straightforward to prove
that reduction preserves denotations.

<pre class="Agda">{% raw %}<a id="preserve"></a><a id="6771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6780" class="Symbol">:</a> <a id="6782" class="Symbol">∀</a> <a id="6784" class="Symbol">{</a><a id="6785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6785" class="Bound">Γ</a><a id="6786" class="Symbol">}</a> <a id="6788" class="Symbol">{</a><a id="6789" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6789" class="Bound">γ</a> <a id="6791" class="Symbol">:</a> <a id="6793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="6797" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6785" class="Bound">Γ</a><a id="6798" class="Symbol">}</a> <a id="6800" class="Symbol">{</a><a id="6801" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6801" class="Bound">M</a> <a id="6803" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6803" class="Bound">N</a> <a id="6805" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6805" class="Bound">v</a><a id="6806" class="Symbol">}</a>
  <a id="6810" class="Symbol">→</a> <a id="6812" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6789" class="Bound">γ</a> <a id="6814" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="6816" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6801" class="Bound">M</a> <a id="6818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="6820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6805" class="Bound">v</a>
  <a id="6824" class="Symbol">→</a> <a id="6826" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6801" class="Bound">M</a> <a id="6828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#386" class="Datatype Operator">—→</a> <a id="6831" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6803" class="Bound">N</a>
    <a id="6837" class="Comment">----------</a>
  <a id="6850" class="Symbol">→</a> <a id="6852" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6789" class="Bound">γ</a> <a id="6854" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="6856" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6803" class="Bound">N</a> <a id="6858" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="6860" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6805" class="Bound">v</a>
<a id="6862" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6871" class="Symbol">(</a><a id="6872" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a><a id="6875" class="Symbol">)</a> <a id="6877" class="Symbol">()</a>
<a id="6880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6889" class="Symbol">(</a><a id="6890" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="6897" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6897" class="Bound">d₁</a> <a id="6900" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6900" class="Bound">d₂</a><a id="6902" class="Symbol">)</a> <a id="6904" class="Symbol">(</a><a id="6905" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#436" class="InductiveConstructor">ξ₁</a> <a id="6908" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6908" class="Bound">r</a><a id="6909" class="Symbol">)</a> <a id="6911" class="Symbol">=</a> <a id="6913" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="6920" class="Symbol">(</a><a id="6921" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6930" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6897" class="Bound">d₁</a> <a id="6933" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6908" class="Bound">r</a><a id="6934" class="Symbol">)</a> <a id="6936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6900" class="Bound">d₂</a> 
<a id="6940" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6949" class="Symbol">(</a><a id="6950" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="6957" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6957" class="Bound">d₁</a> <a id="6960" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6960" class="Bound">d₂</a><a id="6962" class="Symbol">)</a> <a id="6964" class="Symbol">(</a><a id="6965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#526" class="InductiveConstructor">ξ₂</a> <a id="6968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6968" class="Bound">r</a><a id="6969" class="Symbol">)</a> <a id="6971" class="Symbol">=</a> <a id="6973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="6980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6957" class="Bound">d₁</a> <a id="6983" class="Symbol">(</a><a id="6984" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="6993" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6960" class="Bound">d₂</a> <a id="6996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6968" class="Bound">r</a><a id="6997" class="Symbol">)</a> 
<a id="7000" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7009" class="Symbol">(</a><a id="7010" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="7017" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7017" class="Bound">d₁</a> <a id="7020" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7020" class="Bound">d₂</a><a id="7022" class="Symbol">)</a> <a id="7024" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#616" class="InductiveConstructor">β</a> <a id="7026" class="Symbol">=</a> <a id="7028" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#5789" class="Function">substitution</a> <a id="7041" class="Symbol">(</a><a id="7042" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#3272" class="Function">lambda-inversion</a> <a id="7059" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7017" class="Bound">d₁</a><a id="7061" class="Symbol">)</a> <a id="7063" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7020" class="Bound">d₂</a>
<a id="7066" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7075" class="Symbol">(</a><a id="7076" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="7084" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7084" class="Bound">d</a><a id="7085" class="Symbol">)</a> <a id="7087" class="Symbol">(</a><a id="7088" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#724" class="InductiveConstructor">ζ</a> <a id="7090" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7090" class="Bound">r</a><a id="7091" class="Symbol">)</a> <a id="7093" class="Symbol">=</a> <a id="7095" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="7103" class="Symbol">(</a><a id="7104" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7113" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7084" class="Bound">d</a> <a id="7115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7090" class="Bound">r</a><a id="7116" class="Symbol">)</a>
<a id="7118" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7127" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="7135" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7135" class="Bound">r</a> <a id="7137" class="Symbol">=</a> <a id="7139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>
<a id="7147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7156" class="Symbol">(</a><a id="7157" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="7165" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7165" class="Bound">d</a> <a id="7167" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7167" class="Bound">d₁</a><a id="7169" class="Symbol">)</a> <a id="7171" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7171" class="Bound">r</a> <a id="7173" class="Symbol">=</a> <a id="7175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="7183" class="Symbol">(</a><a id="7184" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7193" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7165" class="Bound">d</a> <a id="7195" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7171" class="Bound">r</a><a id="7196" class="Symbol">)</a> <a id="7198" class="Symbol">(</a><a id="7199" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7208" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7167" class="Bound">d₁</a> <a id="7211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7171" class="Bound">r</a><a id="7212" class="Symbol">)</a>
<a id="7214" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7223" class="Symbol">(</a><a id="7224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="7228" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7228" class="Bound">d</a> <a id="7230" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7230" class="Bound">lt</a><a id="7232" class="Symbol">)</a> <a id="7234" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7234" class="Bound">r</a> <a id="7236" class="Symbol">=</a> <a id="7238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="7242" class="Symbol">(</a><a id="7243" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="7252" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7228" class="Bound">d</a> <a id="7254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7234" class="Bound">r</a><a id="7255" class="Symbol">)</a> <a id="7257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#7230" class="Bound">lt</a>{% endraw %}</pre>

We proceed by induction on the semantics of `M` with case analysis on
the reduction.

* If `M` is a variable, then there is no such reduction.

* If `M` is an application, then the reduction is either a congruence
  (ξ₁ or ξ₂) or β. For each congruence, we use the induction
  hypothesis. For β reduction we use the substitution lemma and the
  `sub` rule.

* The rest of the cases are straightforward.

## Reduction reflects denotations

This section proves that reduction reflects the denotation of a
term. That is, if `N` results in `v`, and if `M` reduces to `N`, then
`M` also results in `v`. While there are some broad similarities
between this proof and the above proof of semantic preservation, we
shall require a few more technical lemmas to obtain this result.

The main challenge is dealing with the substitution in β reduction:

    (ƛ N) · M —→ N [ M ]

We have that `γ ⊢ N [ M ] ↓ v` and need to show that
`γ ⊢ (ƛ N) · M ↓ v`. Now consider the derivation of `γ ⊢ N [ M ] ↓ v`.
The term `M` may occur 0, 1, or many times inside `N [ M ]`. At each of
those occurences, `M` may result in a different value. But to build a
derivation for `(ƛ N) · M`, we need a single value for `M`.  If `M`
occured more than 1 time, then we can join all of the different values
using `⊔`. If `M` occured 0 times, then we do not need any information
about `M` and can therefore use `⊥` for the value of `M`.


### Renaming reflects meaning

Previously we showed that renaming variables preserves meaning.  Now
we prove the opposite, that it reflects meaning. That is,
if `δ ⊢ rename ρ M ↓ v`, then `γ ⊢ M ↓ v`, where `(δ ∘ ρ) `⊑ γ`.

First, we need a variant of a lemma given earlier.
<pre class="Agda">{% raw %}<a id="nth-ext"></a><a id="8963" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8963" class="Function">nth-ext</a> <a id="8971" class="Symbol">:</a> <a id="8973" class="Symbol">∀</a> <a id="8975" class="Symbol">{</a><a id="8976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8976" class="Bound">Γ</a> <a id="8978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8978" class="Bound">Δ</a> <a id="8980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8980" class="Bound">v</a><a id="8981" class="Symbol">}</a> <a id="8983" class="Symbol">{</a><a id="8984" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8984" class="Bound">γ</a> <a id="8986" class="Symbol">:</a> <a id="8988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="8992" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8976" class="Bound">Γ</a><a id="8993" class="Symbol">}</a> <a id="8995" class="Symbol">{</a><a id="8996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8996" class="Bound">δ</a> <a id="8998" class="Symbol">:</a> <a id="9000" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="9004" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8978" class="Bound">Δ</a><a id="9005" class="Symbol">}</a>
  <a id="9009" class="Symbol">→</a> <a id="9011" class="Symbol">(</a><a id="9012" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9012" class="Bound">ρ</a> <a id="9014" class="Symbol">:</a> <a id="9016" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2259" class="Function">Rename</a> <a id="9023" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8976" class="Bound">Γ</a> <a id="9025" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8978" class="Bound">Δ</a><a id="9026" class="Symbol">)</a>
  <a id="9030" class="Symbol">→</a> <a id="9032" class="Symbol">(</a><a id="9033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8996" class="Bound">δ</a> <a id="9035" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="9037" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9012" class="Bound">ρ</a><a id="9038" class="Symbol">)</a> <a id="9040" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">`⊑</a> <a id="9043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8984" class="Bound">γ</a>
    <a id="9049" class="Comment">------------------------------</a>
  <a id="9082" class="Symbol">→</a> <a id="9084" class="Symbol">((</a><a id="9086" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8996" class="Bound">δ</a> <a id="9088" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="9091" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8980" class="Bound">v</a><a id="9092" class="Symbol">)</a> <a id="9094" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="9096" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#5845" class="Function">ext</a> <a id="9100" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9012" class="Bound">ρ</a><a id="9101" class="Symbol">)</a> <a id="9103" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">`⊑</a> <a id="9106" class="Symbol">(</a><a id="9107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8984" class="Bound">γ</a> <a id="9109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="9112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8980" class="Bound">v</a><a id="9113" class="Symbol">)</a>
<a id="9115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8963" class="Function">nth-ext</a> <a id="9123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9123" class="Bound">ρ</a> <a id="9125" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9125" class="Bound">lt</a> <a id="9128" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="9130" class="Symbol">=</a> <a id="9132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5530" class="Function">Refl⊑</a>
<a id="9138" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8963" class="Function">nth-ext</a> <a id="9146" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9146" class="Bound">ρ</a> <a id="9148" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9148" class="Bound">lt</a> <a id="9151" class="Symbol">(</a><a id="9152" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="9154" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9154" class="Bound">x</a><a id="9155" class="Symbol">)</a> <a id="9157" class="Symbol">=</a> <a id="9159" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9148" class="Bound">lt</a> <a id="9162" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9154" class="Bound">x</a>{% endraw %}</pre>

The proof is then as follows.
<pre class="Agda">{% raw %}<a id="rename-reflect"></a><a id="9219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9234" class="Symbol">:</a> <a id="9236" class="Symbol">∀</a> <a id="9238" class="Symbol">{</a><a id="9239" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9239" class="Bound">Γ</a> <a id="9241" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9241" class="Bound">Δ</a> <a id="9243" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9243" class="Bound">v</a><a id="9244" class="Symbol">}</a> <a id="9246" class="Symbol">{</a><a id="9247" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9247" class="Bound">γ</a> <a id="9249" class="Symbol">:</a> <a id="9251" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="9255" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9239" class="Bound">Γ</a><a id="9256" class="Symbol">}</a> <a id="9258" class="Symbol">{</a><a id="9259" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9259" class="Bound">δ</a> <a id="9261" class="Symbol">:</a> <a id="9263" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="9267" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9241" class="Bound">Δ</a><a id="9268" class="Symbol">}</a> <a id="9270" class="Symbol">{</a> <a id="9272" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9272" class="Bound">M</a> <a id="9274" class="Symbol">:</a> <a id="9276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9239" class="Bound">Γ</a> <a id="9278" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="9280" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="9281" class="Symbol">}</a>
  <a id="9285" class="Symbol">→</a> <a id="9287" class="Symbol">{</a><a id="9288" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9288" class="Bound">ρ</a> <a id="9290" class="Symbol">:</a> <a id="9292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2259" class="Function">Rename</a> <a id="9299" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9239" class="Bound">Γ</a> <a id="9301" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9241" class="Bound">Δ</a><a id="9302" class="Symbol">}</a>
  <a id="9306" class="Symbol">→</a> <a id="9308" class="Symbol">(</a><a id="9309" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9259" class="Bound">δ</a> <a id="9311" href="https://agda.github.io/agda-stdlib/v0.17/Function.html#769" class="Function Operator">∘</a> <a id="9313" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9288" class="Bound">ρ</a><a id="9314" class="Symbol">)</a> <a id="9316" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">`⊑</a> <a id="9319" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9247" class="Bound">γ</a>
  <a id="9323" class="Symbol">→</a> <a id="9325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9259" class="Bound">δ</a> <a id="9327" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="9329" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6171" class="Function">rename</a> <a id="9336" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9288" class="Bound">ρ</a> <a id="9338" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9272" class="Bound">M</a> <a id="9340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="9342" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9243" class="Bound">v</a>
    <a id="9348" class="Comment">------------------------------------</a>
  <a id="9387" class="Symbol">→</a> <a id="9389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9247" class="Bound">γ</a> <a id="9391" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="9393" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9272" class="Bound">M</a> <a id="9395" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="9397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9243" class="Bound">v</a>
<a id="9399" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9414" class="Symbol">{</a><a id="9415" class="Argument">M</a> <a id="9417" class="Symbol">=</a> <a id="9419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="9421" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9421" class="Bound">x</a><a id="9422" class="Symbol">}</a> <a id="9424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9424" class="Bound">all-n</a> <a id="9430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9430" class="Bound">d</a> <a id="9432" class="Keyword">with</a> <a id="9437" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9327" class="Function">var-inv</a> <a id="9445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9430" class="Bound">d</a>
<a id="9447" class="Symbol">...</a> <a id="9451" class="Symbol">|</a> <a id="9453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9453" class="Bound">lt</a> <a id="9456" class="Symbol">=</a>  <a id="9459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="9463" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="9467" class="Symbol">(</a><a id="9468" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4657" class="InductiveConstructor">Trans⊑</a> <a id="9475" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9453" class="Bound">lt</a> <a id="9478" class="Symbol">(</a><a id="9479" class="Bound">all-n</a> <a id="9485" class="Bound">x</a><a id="9486" class="Symbol">))</a>
<a id="9489" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9504" class="Symbol">{</a><a id="9505" class="Argument">M</a> <a id="9507" class="Symbol">=</a> <a id="9509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="9511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9511" class="Bound">N</a><a id="9512" class="Symbol">}{</a><a id="9514" class="Argument">ρ</a> <a id="9516" class="Symbol">=</a> <a id="9518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9518" class="Bound">ρ</a><a id="9519" class="Symbol">}</a> <a id="9521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9521" class="Bound">all-n</a> <a id="9527" class="Symbol">(</a><a id="9528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="9536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9536" class="Bound">d</a><a id="9537" class="Symbol">)</a> <a id="9539" class="Symbol">=</a>
   <a id="9544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="9552" class="Symbol">(</a><a id="9553" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9568" class="Symbol">(</a><a id="9569" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#8963" class="Function">nth-ext</a> <a id="9577" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9518" class="Bound">ρ</a> <a id="9579" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9521" class="Bound">all-n</a><a id="9584" class="Symbol">)</a> <a id="9586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9536" class="Bound">d</a><a id="9587" class="Symbol">)</a>
<a id="9589" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9604" class="Symbol">{</a><a id="9605" class="Argument">M</a> <a id="9607" class="Symbol">=</a> <a id="9609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="9611" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9611" class="Bound">N</a><a id="9612" class="Symbol">}</a> <a id="9614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9614" class="Bound">all-n</a> <a id="9620" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="9628" class="Symbol">=</a> <a id="9630" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>
<a id="9638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9653" class="Symbol">{</a><a id="9654" class="Argument">M</a> <a id="9656" class="Symbol">=</a> <a id="9658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="9660" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9660" class="Bound">N</a><a id="9661" class="Symbol">}</a> <a id="9663" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9663" class="Bound">all-n</a> <a id="9669" class="Symbol">(</a><a id="9670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="9678" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9678" class="Bound">d₁</a> <a id="9681" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9681" class="Bound">d₂</a><a id="9683" class="Symbol">)</a> <a id="9685" class="Symbol">=</a>
   <a id="9690" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="9698" class="Symbol">(</a><a id="9699" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9714" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9663" class="Bound">all-n</a> <a id="9720" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9678" class="Bound">d₁</a><a id="9722" class="Symbol">)</a> <a id="9724" class="Symbol">(</a><a id="9725" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9740" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9663" class="Bound">all-n</a> <a id="9746" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9681" class="Bound">d₂</a><a id="9748" class="Symbol">)</a>
<a id="9750" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9765" class="Symbol">{</a><a id="9766" class="Argument">M</a> <a id="9768" class="Symbol">=</a> <a id="9770" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="9772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9772" class="Bound">N</a><a id="9773" class="Symbol">}</a> <a id="9775" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9775" class="Bound">all-n</a> <a id="9781" class="Symbol">(</a><a id="9782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="9786" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9786" class="Bound">d₁</a> <a id="9789" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9789" class="Bound">lt</a><a id="9791" class="Symbol">)</a> <a id="9793" class="Symbol">=</a>
   <a id="9798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="9802" class="Symbol">(</a><a id="9803" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9775" class="Bound">all-n</a> <a id="9824" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9786" class="Bound">d₁</a><a id="9826" class="Symbol">)</a> <a id="9828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9789" class="Bound">lt</a>
<a id="9831" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9846" class="Symbol">{</a><a id="9847" class="Argument">M</a> <a id="9849" class="Symbol">=</a> <a id="9851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9851" class="Bound">L</a> <a id="9853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="9855" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9855" class="Bound">M</a><a id="9856" class="Symbol">}</a> <a id="9858" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9858" class="Bound">all-n</a> <a id="9864" class="Symbol">(</a><a id="9865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="9872" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9872" class="Bound">d₁</a> <a id="9875" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9875" class="Bound">d₂</a><a id="9877" class="Symbol">)</a> <a id="9879" class="Symbol">=</a>
   <a id="9884" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="9891" class="Symbol">(</a><a id="9892" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9858" class="Bound">all-n</a> <a id="9913" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9872" class="Bound">d₁</a><a id="9915" class="Symbol">)</a> <a id="9917" class="Symbol">(</a><a id="9918" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9933" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9858" class="Bound">all-n</a> <a id="9939" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9875" class="Bound">d₂</a><a id="9941" class="Symbol">)</a> 
<a id="9944" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="9959" class="Symbol">{</a><a id="9960" class="Argument">M</a> <a id="9962" class="Symbol">=</a> <a id="9964" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9964" class="Bound">L</a> <a id="9966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="9968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9968" class="Bound">M</a><a id="9969" class="Symbol">}</a> <a id="9971" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9971" class="Bound">all-n</a> <a id="9977" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="9985" class="Symbol">=</a> <a id="9987" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>
<a id="9995" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="10010" class="Symbol">{</a><a id="10011" class="Argument">M</a> <a id="10013" class="Symbol">=</a> <a id="10015" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10015" class="Bound">L</a> <a id="10017" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="10019" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10019" class="Bound">M</a><a id="10020" class="Symbol">}</a> <a id="10022" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10022" class="Bound">all-n</a> <a id="10028" class="Symbol">(</a><a id="10029" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="10037" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10037" class="Bound">d₁</a> <a id="10040" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10040" class="Bound">d₂</a><a id="10042" class="Symbol">)</a> <a id="10044" class="Symbol">=</a>
   <a id="10049" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="10057" class="Symbol">(</a><a id="10058" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="10073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10022" class="Bound">all-n</a> <a id="10079" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10037" class="Bound">d₁</a><a id="10081" class="Symbol">)</a> <a id="10083" class="Symbol">(</a><a id="10084" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="10099" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10022" class="Bound">all-n</a> <a id="10105" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10040" class="Bound">d₂</a><a id="10107" class="Symbol">)</a>
<a id="10109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="10124" class="Symbol">{</a><a id="10125" class="Argument">M</a> <a id="10127" class="Symbol">=</a> <a id="10129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10129" class="Bound">L</a> <a id="10131" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="10133" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10133" class="Bound">M</a><a id="10134" class="Symbol">}</a> <a id="10136" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10136" class="Bound">all-n</a> <a id="10142" class="Symbol">(</a><a id="10143" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="10147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10147" class="Bound">d₁</a> <a id="10150" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10150" class="Bound">lt</a><a id="10152" class="Symbol">)</a> <a id="10154" class="Symbol">=</a>
   <a id="10159" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="10163" class="Symbol">(</a><a id="10164" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="10179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10136" class="Bound">all-n</a> <a id="10185" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10147" class="Bound">d₁</a><a id="10187" class="Symbol">)</a> <a id="10189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#10150" class="Bound">lt</a>{% endraw %}</pre>

We cannot prove this lemma by induction on the derivation of
`δ ⊢ rename ρ M ↓ v`, so instead we proceed by induction on `M`.

* If it is a variable, we apply the inversion lemma to obtain
  that `v ⊑ nth (ρ x) δ`. Instantiating the premise to `x` we have
  `nth (ρ x) δ = nth x γ`, so we conclude by the `var` rule.

* If it is a lambda abstraction `ƛ N`, we have
  rename `ρ (ƛ N) = ƛ (rename (ext ρ) N)`.
  We proceed by cases on `δ ⊢ ƛ (rename (ext ρ) N) ↓ v`.

  * Rule `↦-intro`: To satisfy the premise of the induction
    hypothesis, we prove that the renaming can be extended to be a
    mapping from `γ , v₁ to δ , v₁`.

  * Rule `⊥-intro`: We simply apply `⊥-intro`.

  * Rule `⊔-intro`: We apply the induction hypotheses and `⊔-intro`.

  * Rule `sub`: We apply the induction hypothesis and `sub`.

* If it is an application `L · M`, we have
  `rename ρ (L · M) = (rename ρ L) · (rename ρ M)`.
  We proceed by cases on `δ ⊢ (rename ρ L) · (rename ρ M) ↓ v`
  and all the cases are straightforward.

In the upcoming uses of `rename-reflect`, the renaming will always be
the increment function. So we prove a corollary for that special case.

<pre class="Agda">{% raw %}<a id="rename-inc-reflect"></a><a id="11370" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11370" class="Function">rename-inc-reflect</a> <a id="11389" class="Symbol">:</a> <a id="11391" class="Symbol">∀</a> <a id="11393" class="Symbol">{</a><a id="11394" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11394" class="Bound">Γ</a> <a id="11396" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11396" class="Bound">v′</a> <a id="11399" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11399" class="Bound">v</a><a id="11400" class="Symbol">}</a> <a id="11402" class="Symbol">{</a><a id="11403" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11403" class="Bound">γ</a> <a id="11405" class="Symbol">:</a> <a id="11407" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="11411" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11394" class="Bound">Γ</a><a id="11412" class="Symbol">}</a> <a id="11414" class="Symbol">{</a> <a id="11416" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11416" class="Bound">M</a> <a id="11418" class="Symbol">:</a> <a id="11420" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11394" class="Bound">Γ</a> <a id="11422" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="11424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="11425" class="Symbol">}</a>
  <a id="11429" class="Symbol">→</a> <a id="11431" class="Symbol">(</a><a id="11432" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11403" class="Bound">γ</a> <a id="11434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="11437" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11396" class="Bound">v′</a><a id="11439" class="Symbol">)</a> <a id="11441" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="11443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6171" class="Function">rename</a> <a id="11450" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S_</a> <a id="11453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11416" class="Bound">M</a> <a id="11455" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="11457" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11399" class="Bound">v</a>
    <a id="11463" class="Comment">----------------------------</a>
  <a id="11494" class="Symbol">→</a> <a id="11496" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11403" class="Bound">γ</a> <a id="11498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="11500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11416" class="Bound">M</a> <a id="11502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="11504" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11399" class="Bound">v</a>
<a id="11506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11370" class="Function">rename-inc-reflect</a> <a id="11525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11525" class="Bound">d</a> <a id="11527" class="Symbol">=</a> <a id="11529" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#9219" class="Function">rename-reflect</a> <a id="11544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8767" class="Function">`Refl⊑</a> <a id="11551" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11525" class="Bound">d</a>{% endraw %}</pre>


### Substitution reflects denotations, the variable case

We are almost ready to begin proving that simultaneous substitution
reflects denotations. That is, if `γ ⊢ (subst σ M) ↓ v`, then
`γ ⊢ σ k ↓ nth k δ` and `δ ⊢ M ↓ v` for any `k` and some `δ`.
We shall start with the case in which `M` is a variable `x`.
So instead the premise is `γ ⊢ σ x ↓ v` and we need to show that
`δ ⊢ x ↓ v` for some `δ`. The `δ` that we choose shall be the
environment that maps `x` to `v` and every other variable to `⊥`.

The nth element of the `⊥ environment is always ⊥.
[PLW: Probably can omit]
<pre class="Agda">{% raw %}<a id="nth-`⊥"></a><a id="12160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12160" class="Function">nth-`⊥</a> <a id="12167" class="Symbol">:</a> <a id="12169" class="Symbol">∀{</a><a id="12171" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12171" class="Bound">Γ</a><a id="12172" class="Symbol">}</a> <a id="12174" class="Symbol">{</a><a id="12175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12175" class="Bound">x</a> <a id="12177" class="Symbol">:</a> <a id="12179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12171" class="Bound">Γ</a> <a id="12181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="12183" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="12184" class="Symbol">}</a> <a id="12186" class="Symbol">→</a> <a id="12188" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8468" class="Function">`⊥</a> <a id="12191" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12175" class="Bound">x</a> <a id="12193" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12195" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4009" class="InductiveConstructor">⊥</a>
<a id="12197" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12160" class="Function">nth-`⊥</a> <a id="12204" class="Symbol">{</a><a id="12205" class="Argument">x</a> <a id="12207" class="Symbol">=</a> <a id="12209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a><a id="12210" class="Symbol">}</a> <a id="12212" class="Symbol">=</a> <a id="12214" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="12219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12160" class="Function">nth-`⊥</a> <a id="12226" class="Symbol">{</a><a id="12227" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12227" class="Bound">Γ</a> <a id="12229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="12231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="12232" class="Symbol">}</a> <a id="12234" class="Symbol">{</a><a id="12235" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12237" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12237" class="Bound">x</a><a id="12238" class="Symbol">}</a> <a id="12240" class="Symbol">=</a> <a id="12242" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12160" class="Function">nth-`⊥</a> <a id="12249" class="Symbol">{</a><a id="12250" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12227" class="Bound">Γ</a><a id="12251" class="Symbol">}</a> <a id="12253" class="Symbol">{</a><a id="12254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12237" class="Bound">x</a><a id="12255" class="Symbol">}</a>{% endraw %}</pre>

Next we define the environment that maps `x` to `v` and every other
variable to `⊥`, that is `const-env x v`.

<pre class="Agda">{% raw %}<a id="12393" class="Comment">{-
inv-S : ∀ {Γ A B} {x y : Γ ∋ A}
  → _≡_ {_} {Γ , B ∋ A} (S x) (S y)
  → S x ≡ S y
    -------------------------------
  → x ≡ y
inv-S refl = refl
-}</a>

<a id="_var≟_"></a><a id="12546" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">_var≟_</a> <a id="12553" class="Symbol">:</a> <a id="12555" class="Symbol">∀</a> <a id="12557" class="Symbol">{</a><a id="12558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12558" class="Bound">Γ</a><a id="12559" class="Symbol">}</a> <a id="12561" class="Symbol">→</a> <a id="12563" class="Symbol">(</a><a id="12564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12564" class="Bound">x</a> <a id="12566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12566" class="Bound">y</a> <a id="12568" class="Symbol">:</a> <a id="12570" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12558" class="Bound">Γ</a> <a id="12572" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="12574" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="12575" class="Symbol">)</a> <a id="12577" class="Symbol">→</a> <a id="12579" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#534" class="Datatype">Dec</a> <a id="12583" class="Symbol">(</a><a id="12584" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12564" class="Bound">x</a> <a id="12586" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12588" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12566" class="Bound">y</a><a id="12589" class="Symbol">)</a>
<a id="12591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="12593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a>  <a id="12601" class="Symbol">=</a>  <a id="12604" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="12608" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="12613" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="12615" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12620" class="Symbol">(</a><a id="12621" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12623" class="Symbol">_)</a>  <a id="12627" class="Symbol">=</a>  <a id="12630" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="12633" class="Symbol">λ()</a>
<a id="12637" class="Symbol">(</a><a id="12638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12640" class="Symbol">_)</a> <a id="12643" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a>  <a id="12651" class="Symbol">=</a>  <a id="12654" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="12657" class="Symbol">λ()</a>
<a id="12661" class="Symbol">(</a><a id="12662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12664" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12664" class="Bound">x</a><a id="12665" class="Symbol">)</a> <a id="12667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12672" class="Symbol">(</a><a id="12673" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12675" class="Bound">y</a><a id="12676" class="Symbol">)</a> <a id="12678" class="Keyword">with</a>  <a id="12684" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12664" class="Bound">x</a> <a id="12686" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12691" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12675" class="Bound">y</a>
<a id="12693" class="Symbol">...</a>                 <a id="12713" class="Symbol">|</a>  <a id="12716" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="12720" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12725" class="Symbol">=</a>  <a id="12728" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="12732" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="12737" class="Symbol">...</a>                 <a id="12757" class="Symbol">|</a>  <a id="12760" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="12763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12763" class="Bound">neq</a>   <a id="12769" class="Symbol">=</a>  <a id="12772" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="12775" class="Symbol">λ{</a><a id="12777" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="12782" class="Symbol">→</a> <a id="12784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12763" class="Bound">neq</a> <a id="12788" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="12792" class="Symbol">}</a>

<a id="var≟-refl"></a><a id="12795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12795" class="Function">var≟-refl</a> <a id="12805" class="Symbol">:</a> <a id="12807" class="Symbol">∀</a> <a id="12809" class="Symbol">{</a><a id="12810" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12810" class="Bound">Γ</a><a id="12811" class="Symbol">}</a> <a id="12813" class="Symbol">(</a><a id="12814" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12814" class="Bound">x</a> <a id="12816" class="Symbol">:</a> <a id="12818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12810" class="Bound">Γ</a> <a id="12820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="12822" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="12823" class="Symbol">)</a> <a id="12825" class="Symbol">→</a> <a id="12827" class="Symbol">(</a><a id="12828" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12814" class="Bound">x</a> <a id="12830" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12835" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12814" class="Bound">x</a><a id="12836" class="Symbol">)</a> <a id="12838" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="12840" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="12844" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="12849" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12795" class="Function">var≟-refl</a> <a id="12859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="12861" class="Symbol">=</a> <a id="12863" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="12868" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12795" class="Function">var≟-refl</a> <a id="12878" class="Symbol">(</a><a id="12879" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="12881" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12881" class="Bound">x</a><a id="12882" class="Symbol">)</a> <a id="12884" class="Keyword">rewrite</a> <a id="12892" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12795" class="Function">var≟-refl</a> <a id="12902" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12881" class="Bound">x</a> <a id="12904" class="Symbol">=</a> <a id="12906" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>

<a id="const-env"></a><a id="12912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="12922" class="Symbol">:</a> <a id="12924" class="Symbol">∀{</a><a id="12926" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12926" class="Bound">Γ</a><a id="12927" class="Symbol">}</a> <a id="12929" class="Symbol">→</a> <a id="12931" class="Symbol">(</a><a id="12932" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12932" class="Bound">x</a> <a id="12934" class="Symbol">:</a> <a id="12936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12926" class="Bound">Γ</a> <a id="12938" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="12940" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="12941" class="Symbol">)</a> <a id="12943" class="Symbol">→</a> <a id="12945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#3989" class="Datatype">Value</a> <a id="12951" class="Symbol">→</a> <a id="12953" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="12957" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12926" class="Bound">Γ</a>
<a id="12959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="12969" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12969" class="Bound">x</a> <a id="12971" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12971" class="Bound">v</a> <a id="12973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12973" class="Bound">y</a> <a id="12975" class="Keyword">with</a> <a id="12980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12969" class="Bound">x</a> <a id="12982" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="12987" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12973" class="Bound">y</a>
<a id="12989" class="Symbol">...</a>             <a id="13005" class="Symbol">|</a> <a id="13007" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="13011" class="Symbol">_</a>       <a id="13019" class="Symbol">=</a> <a id="13021" class="Bound">v</a>
<a id="13023" class="Symbol">...</a>             <a id="13039" class="Symbol">|</a> <a id="13041" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="13044" class="Symbol">_</a>        <a id="13053" class="Symbol">=</a> <a id="13055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4009" class="InductiveConstructor">⊥</a>{% endraw %}</pre>

Of course, the nth element of `const-env n v` is the value `v`.

<pre class="Agda">{% raw %}<a id="nth-const-env"></a><a id="13147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13147" class="Function">nth-const-env</a> <a id="13161" class="Symbol">:</a> <a id="13163" class="Symbol">∀{</a><a id="13165" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13165" class="Bound">Γ</a><a id="13166" class="Symbol">}</a> <a id="13168" class="Symbol">{</a><a id="13169" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13169" class="Bound">x</a> <a id="13171" class="Symbol">:</a> <a id="13173" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13165" class="Bound">Γ</a> <a id="13175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="13177" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="13178" class="Symbol">}</a> <a id="13180" class="Symbol">{</a><a id="13181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13181" class="Bound">v</a><a id="13182" class="Symbol">}</a> <a id="13184" class="Symbol">→</a> <a id="13186" class="Symbol">(</a><a id="13187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="13197" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13169" class="Bound">x</a> <a id="13199" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13181" class="Bound">v</a><a id="13200" class="Symbol">)</a> <a id="13202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13169" class="Bound">x</a> <a id="13204" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13206" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13181" class="Bound">v</a>
<a id="13208" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13147" class="Function">nth-const-env</a> <a id="13222" class="Symbol">{</a><a id="13223" class="Argument">x</a> <a id="13225" class="Symbol">=</a> <a id="13227" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13227" class="Bound">x</a><a id="13228" class="Symbol">}</a> <a id="13230" class="Keyword">rewrite</a> <a id="13238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12795" class="Function">var≟-refl</a> <a id="13248" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13227" class="Bound">x</a> <a id="13250" class="Symbol">=</a> <a id="13252" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>{% endraw %}</pre>

The nth element of `const-env n′ v` is the value `⊥, so long as `n ≢ n′`.

<pre class="Agda">{% raw %}<a id="diff-nth-const-env"></a><a id="13357" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13357" class="Function">diff-nth-const-env</a> <a id="13376" class="Symbol">:</a> <a id="13378" class="Symbol">∀{</a><a id="13380" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13380" class="Bound">Γ</a><a id="13381" class="Symbol">}</a> <a id="13383" class="Symbol">{</a><a id="13384" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13384" class="Bound">x</a> <a id="13386" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13386" class="Bound">y</a> <a id="13388" class="Symbol">:</a> <a id="13390" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13380" class="Bound">Γ</a> <a id="13392" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="13394" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="13395" class="Symbol">}</a> <a id="13397" class="Symbol">{</a><a id="13398" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13398" class="Bound">v</a><a id="13399" class="Symbol">}</a>
  <a id="13403" class="Symbol">→</a> <a id="13405" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13384" class="Bound">x</a> <a id="13407" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#660" class="Function Operator">≢</a> <a id="13409" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13386" class="Bound">y</a>
    <a id="13415" class="Comment">-------------------</a>
  <a id="13437" class="Symbol">→</a> <a id="13439" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="13449" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13384" class="Bound">x</a> <a id="13451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13398" class="Bound">v</a> <a id="13453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13386" class="Bound">y</a> <a id="13455" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="13457" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4009" class="InductiveConstructor">⊥</a>
<a id="13459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13357" class="Function">diff-nth-const-env</a> <a id="13478" class="Symbol">{</a><a id="13479" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13479" class="Bound">Γ</a><a id="13480" class="Symbol">}</a> <a id="13482" class="Symbol">{</a><a id="13483" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13483" class="Bound">x</a><a id="13484" class="Symbol">}</a> <a id="13486" class="Symbol">{</a><a id="13487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13487" class="Bound">y</a><a id="13488" class="Symbol">}</a> <a id="13490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13490" class="Bound">neq</a> <a id="13494" class="Keyword">with</a> <a id="13499" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13483" class="Bound">x</a> <a id="13501" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="13506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13487" class="Bound">y</a>
<a id="13508" class="Symbol">...</a>  <a id="13513" class="Symbol">|</a> <a id="13515" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="13519" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13519" class="Bound">eq</a>  <a id="13523" class="Symbol">=</a>  <a id="13526" href="https://agda.github.io/agda-stdlib/v0.17/Data.Empty.html#360" class="Function">⊥-elim</a> <a id="13533" class="Symbol">(</a><a id="13534" class="Bound">neq</a> <a id="13538" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13519" class="Bound">eq</a><a id="13540" class="Symbol">)</a>
<a id="13542" class="Symbol">...</a>  <a id="13547" class="Symbol">|</a> <a id="13549" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="13552" class="Symbol">_</a>    <a id="13557" class="Symbol">=</a>  <a id="13560" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>{% endraw %}</pre>

So we choose `const-env x v` for `δ` and obtain `δ ⊢ x ↓ v`
with the `var` rule.

It remains to prove that `γ ⊢ σ ↓ δ` and `δ ⊢ M ↓ v` for any `k`, given that
we have chosen `const-env x v` for `δ`.  We shall have two cases to
consider, `x ≡ y` or `x ≢ y`.

Now to finish the two cases of the proof.

* In the case where `x ≡ y`, we need to show
  that `γ ⊢ σ y ↓ v`, but that's just our premise.
* In the case where `x ≢ y,` we need to show
  that `γ ⊢ σ y ↓ ⊥`, which we do via rule `⊥-intro`.

Thus, we have completed the variable case of the proof that
simultaneous substitution reflects denotations.  Here is the proof
again, formally.

<pre class="Agda">{% raw %}<a id="subst-reflect-var"></a><a id="14232" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14232" class="Function">subst-reflect-var</a> <a id="14250" class="Symbol">:</a> <a id="14252" class="Symbol">∀</a> <a id="14254" class="Symbol">{</a><a id="14255" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14255" class="Bound">Γ</a> <a id="14257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14257" class="Bound">Δ</a><a id="14258" class="Symbol">}</a> <a id="14260" class="Symbol">{</a><a id="14261" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14261" class="Bound">γ</a> <a id="14263" class="Symbol">:</a> <a id="14265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="14269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14257" class="Bound">Δ</a><a id="14270" class="Symbol">}</a> <a id="14272" class="Symbol">{</a><a id="14273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14273" class="Bound">x</a> <a id="14275" class="Symbol">:</a> <a id="14277" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14255" class="Bound">Γ</a> <a id="14279" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="14281" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="14282" class="Symbol">}</a> <a id="14284" class="Symbol">{</a><a id="14285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14285" class="Bound">v</a><a id="14286" class="Symbol">}</a> <a id="14288" class="Symbol">{</a><a id="14289" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14289" class="Bound">σ</a> <a id="14291" class="Symbol">:</a> <a id="14293" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="14299" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14255" class="Bound">Γ</a> <a id="14301" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14257" class="Bound">Δ</a><a id="14302" class="Symbol">}</a>
  <a id="14306" class="Symbol">→</a> <a id="14308" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14261" class="Bound">γ</a> <a id="14310" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="14312" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14289" class="Bound">σ</a> <a id="14314" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14273" class="Bound">x</a> <a id="14316" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="14318" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14285" class="Bound">v</a>
    <a id="14324" class="Comment">-----------------------------------------</a>
  <a id="14368" class="Symbol">→</a> <a id="14370" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">Σ[</a> <a id="14373" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14373" class="Bound">δ</a> <a id="14375" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">∈</a> <a id="14377" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="14381" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14255" class="Bound">Γ</a> <a id="14383" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">]</a> <a id="14385" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14261" class="Bound">γ</a> <a id="14387" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="14390" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14289" class="Bound">σ</a> <a id="14392" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="14394" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14373" class="Bound">δ</a>  <a id="14397" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#1353" class="Function Operator">×</a>  <a id="14400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14373" class="Bound">δ</a> <a id="14402" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="14404" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="14406" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14273" class="Bound">x</a> <a id="14408" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="14410" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14285" class="Bound">v</a>
<a id="14412" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14232" class="Function">subst-reflect-var</a> <a id="14430" class="Symbol">{</a><a id="14431" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14431" class="Bound">Γ</a><a id="14432" class="Symbol">}{</a><a id="14434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14434" class="Bound">Δ</a><a id="14435" class="Symbol">}{</a><a id="14437" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14437" class="Bound">γ</a><a id="14438" class="Symbol">}{</a><a id="14440" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a><a id="14441" class="Symbol">}{</a><a id="14443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a><a id="14444" class="Symbol">}{</a><a id="14446" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14446" class="Bound">σ</a><a id="14447" class="Symbol">}</a> <a id="14449" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14449" class="Bound">xv</a>
  <a id="14454" class="Keyword">rewrite</a> <a id="14462" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="14466" class="Symbol">(</a><a id="14467" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13147" class="Function">nth-const-env</a> <a id="14481" class="Symbol">{</a><a id="14482" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14431" class="Bound">Γ</a><a id="14483" class="Symbol">}{</a><a id="14485" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a><a id="14486" class="Symbol">}{</a><a id="14488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a><a id="14489" class="Symbol">})</a> <a id="14492" class="Symbol">=</a>
    <a id="14498" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="14500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="14510" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a> <a id="14512" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a> <a id="14514" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="14516" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="14518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14551" class="Function">const-env-ok</a> <a id="14531" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="14533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="14537" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="14539" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
  <a id="14543" class="Keyword">where</a>
  <a id="14551" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14551" class="Function">const-env-ok</a> <a id="14564" class="Symbol">:</a> <a id="14566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14437" class="Bound">γ</a> <a id="14568" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="14571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14446" class="Bound">σ</a> <a id="14573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="14575" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12912" class="Function">const-env</a> <a id="14585" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a> <a id="14587" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a>
  <a id="14591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14551" class="Function">const-env-ok</a> <a id="14604" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14604" class="Bound">y</a> <a id="14606" class="Keyword">with</a> <a id="14611" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a> <a id="14613" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#12546" class="Function Operator">var≟</a> <a id="14618" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14604" class="Bound">y</a>
  <a id="14622" class="Symbol">...</a> <a id="14626" class="Symbol">|</a> <a id="14628" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#570" class="InductiveConstructor">yes</a> <a id="14632" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14632" class="Bound">x≡y</a> <a id="14636" class="Keyword">rewrite</a> <a id="14644" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="14648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14632" class="Bound">x≡y</a> <a id="14652" class="Symbol">|</a> <a id="14654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13147" class="Function">nth-const-env</a> <a id="14668" class="Symbol">{</a><a id="14669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14431" class="Bound">Γ</a><a id="14670" class="Symbol">}{</a><a id="14672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a><a id="14673" class="Symbol">}{</a><a id="14675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a><a id="14676" class="Symbol">}</a> <a id="14678" class="Symbol">=</a> <a id="14680" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14449" class="Bound">xv</a>
  <a id="14685" class="Symbol">...</a> <a id="14689" class="Symbol">|</a> <a id="14691" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Nullary.html#597" class="InductiveConstructor">no</a> <a id="14694" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14694" class="Bound">x≢y</a> <a id="14698" class="Keyword">rewrite</a> <a id="14706" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#13357" class="Function">diff-nth-const-env</a> <a id="14725" class="Symbol">{</a><a id="14726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14431" class="Bound">Γ</a><a id="14727" class="Symbol">}{</a><a id="14729" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14440" class="Bound">x</a><a id="14730" class="Symbol">}{</a><a id="14732" class="Bound">y</a><a id="14733" class="Symbol">}{</a><a id="14735" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14443" class="Bound">v</a><a id="14736" class="Symbol">}</a> <a id="14738" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14694" class="Bound">x≢y</a> <a id="14742" class="Symbol">=</a> <a id="14744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>{% endraw %}</pre>


### Substitutions and environment construction

Every substitution produces terms that can evaluate to `⊥`.

<pre class="Agda">{% raw %}<a id="subst-⊥"></a><a id="14887" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14887" class="Function">subst-⊥</a> <a id="14895" class="Symbol">:</a> <a id="14897" class="Symbol">∀{</a><a id="14899" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14899" class="Bound">Γ</a> <a id="14901" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14901" class="Bound">Δ</a><a id="14902" class="Symbol">}{</a><a id="14904" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14904" class="Bound">γ</a> <a id="14906" class="Symbol">:</a> <a id="14908" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="14912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14901" class="Bound">Δ</a><a id="14913" class="Symbol">}{</a><a id="14915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14915" class="Bound">σ</a> <a id="14917" class="Symbol">:</a> <a id="14919" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="14925" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14899" class="Bound">Γ</a> <a id="14927" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14901" class="Bound">Δ</a><a id="14928" class="Symbol">}</a>
    <a id="14934" class="Comment">-----------------</a>
  <a id="14954" class="Symbol">→</a> <a id="14956" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14904" class="Bound">γ</a> <a id="14958" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="14961" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14915" class="Bound">σ</a> <a id="14963" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="14965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8468" class="Function">`⊥</a>
<a id="14968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14887" class="Function">subst-⊥</a> <a id="14976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14976" class="Bound">x</a> <a id="14978" class="Symbol">=</a> <a id="14980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>{% endraw %}</pre>

If a substitution produces terms that evaluate to the values in
both `γ₁` and `γ₂`, then those terms also evaluate to the values in 
`γ₁ ⊔ γ₂`.

<pre class="Agda">{% raw %}<a id="subst-⊔"></a><a id="15158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15158" class="Function">subst-⊔</a> <a id="15166" class="Symbol">:</a> <a id="15168" class="Symbol">∀{</a><a id="15170" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15170" class="Bound">Γ</a> <a id="15172" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15172" class="Bound">Δ</a><a id="15173" class="Symbol">}{</a><a id="15175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15175" class="Bound">γ</a> <a id="15177" class="Symbol">:</a> <a id="15179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="15183" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15172" class="Bound">Δ</a><a id="15184" class="Symbol">}{</a><a id="15186" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15186" class="Bound">γ₁</a> <a id="15189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15189" class="Bound">γ₂</a> <a id="15192" class="Symbol">:</a> <a id="15194" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="15198" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15170" class="Bound">Γ</a><a id="15199" class="Symbol">}{</a><a id="15201" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15201" class="Bound">σ</a> <a id="15203" class="Symbol">:</a> <a id="15205" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="15211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15170" class="Bound">Γ</a> <a id="15213" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15172" class="Bound">Δ</a><a id="15214" class="Symbol">}</a>
           <a id="15227" class="Symbol">→</a> <a id="15229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15175" class="Bound">γ</a> <a id="15231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="15234" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15201" class="Bound">σ</a> <a id="15236" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="15238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15186" class="Bound">γ₁</a>
           <a id="15252" class="Symbol">→</a> <a id="15254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15175" class="Bound">γ</a> <a id="15256" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="15259" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15201" class="Bound">σ</a> <a id="15261" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="15263" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15189" class="Bound">γ₂</a>
             <a id="15279" class="Comment">-------------------------</a>
           <a id="15316" class="Symbol">→</a> <a id="15318" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15175" class="Bound">γ</a> <a id="15320" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="15323" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15201" class="Bound">σ</a> <a id="15325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="15327" class="Symbol">(</a><a id="15328" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15186" class="Bound">γ₁</a> <a id="15331" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8497" class="Function Operator">`⊔</a> <a id="15334" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15189" class="Bound">γ₂</a><a id="15336" class="Symbol">)</a>
<a id="15338" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15158" class="Function">subst-⊔</a> <a id="15346" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15346" class="Bound">γ₁-ok</a> <a id="15352" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15352" class="Bound">γ₂-ok</a> <a id="15358" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15358" class="Bound">x</a> <a id="15360" class="Symbol">=</a> <a id="15362" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="15370" class="Symbol">(</a><a id="15371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15346" class="Bound">γ₁-ok</a> <a id="15377" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15358" class="Bound">x</a><a id="15378" class="Symbol">)</a> <a id="15380" class="Symbol">(</a><a id="15381" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15352" class="Bound">γ₂-ok</a> <a id="15387" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15358" class="Bound">x</a><a id="15388" class="Symbol">)</a>{% endraw %}</pre>

### The Lambda constructor is injective

<pre class="Agda">{% raw %}<a id="lambda-inj"></a><a id="15456" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15456" class="Function">lambda-inj</a> <a id="15467" class="Symbol">:</a> <a id="15469" class="Symbol">∀</a> <a id="15471" class="Symbol">{</a><a id="15472" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15472" class="Bound">Γ</a><a id="15473" class="Symbol">}</a> <a id="15475" class="Symbol">{</a><a id="15476" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15476" class="Bound">M</a> <a id="15478" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15478" class="Bound">N</a> <a id="15480" class="Symbol">:</a> <a id="15482" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15472" class="Bound">Γ</a> <a id="15484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="15486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="15488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="15490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="15492" class="Symbol">}</a>
  <a id="15496" class="Symbol">→</a> <a id="15498" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a> <a id="15502" class="Symbol">{</a><a id="15503" class="Argument">A</a> <a id="15505" class="Symbol">=</a> <a id="15507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15472" class="Bound">Γ</a> <a id="15509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="15511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="15512" class="Symbol">}</a> <a id="15514" class="Symbol">(</a><a id="15515" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="15517" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15476" class="Bound">M</a><a id="15518" class="Symbol">)</a> <a id="15520" class="Symbol">(</a><a id="15521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="15523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15478" class="Bound">N</a><a id="15524" class="Symbol">)</a>
    <a id="15530" class="Comment">---------------------------</a>
  <a id="15560" class="Symbol">→</a> <a id="15562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15476" class="Bound">M</a> <a id="15564" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="15566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15478" class="Bound">N</a>
<a id="15568" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15456" class="Function">lambda-inj</a> <a id="15579" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="15584" class="Symbol">=</a> <a id="15586" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>{% endraw %}</pre>

### Simultaneous substitution reflects denotations

In this section we prove a central lemma, that
substitution reflects denotations. That is, if `γ ⊢ subst σ M ↓ v`, then
`δ ⊢ M ↓ v` and `γ ⊢ σ ↓ δ` for some `δ`. We shall proceed by induction on
the derivation of `γ ⊢ subst σ M ↓ v`. This requires a minor
restatement of the lemma, changing the premise to `γ ⊢ L ↓ v` and
`L ≡ subst σ M`.

<pre class="Agda">{% raw %}<a id="split"></a><a id="16008" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16008" class="Function">split</a> <a id="16014" class="Symbol">:</a> <a id="16016" class="Symbol">∀</a> <a id="16018" class="Symbol">{</a><a id="16019" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16019" class="Bound">Γ</a><a id="16020" class="Symbol">}</a> <a id="16022" class="Symbol">{</a><a id="16023" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16023" class="Bound">M</a> <a id="16025" class="Symbol">:</a> <a id="16027" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16019" class="Bound">Γ</a> <a id="16029" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="16031" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="16033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="16035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="16036" class="Symbol">}</a> <a id="16038" class="Symbol">{</a><a id="16039" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16039" class="Bound">δ</a> <a id="16041" class="Symbol">:</a> <a id="16043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="16047" class="Symbol">(</a><a id="16048" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16019" class="Bound">Γ</a> <a id="16050" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="16052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="16053" class="Symbol">)}</a> <a id="16056" class="Symbol">{</a><a id="16057" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16057" class="Bound">v</a><a id="16058" class="Symbol">}</a>
  <a id="16062" class="Symbol">→</a> <a id="16064" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16039" class="Bound">δ</a> <a id="16066" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="16068" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16023" class="Bound">M</a> <a id="16070" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="16072" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16057" class="Bound">v</a>
    <a id="16078" class="Comment">--------------------------</a>
  <a id="16107" class="Symbol">→</a> <a id="16109" class="Symbol">(</a><a id="16110" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7649" class="Function">init</a> <a id="16115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16039" class="Bound">δ</a> <a id="16117" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="16120" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7704" class="Function">last</a> <a id="16125" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16039" class="Bound">δ</a><a id="16126" class="Symbol">)</a> <a id="16128" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="16130" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16023" class="Bound">M</a> <a id="16132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="16134" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16057" class="Bound">v</a>
<a id="16136" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16008" class="Function">split</a> <a id="16142" class="Symbol">{</a><a id="16143" class="Argument">δ</a> <a id="16145" class="Symbol">=</a> <a id="16147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16147" class="Bound">δ</a><a id="16148" class="Symbol">}</a> <a id="16150" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16150" class="Bound">δMv</a> <a id="16154" class="Keyword">rewrite</a> <a id="16162" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7753" class="Function">init-last</a> <a id="16172" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16147" class="Bound">δ</a> <a id="16174" class="Symbol">=</a> <a id="16176" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16150" class="Bound">δMv</a>

<a id="subst-reflect"></a><a id="16181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16195" class="Symbol">:</a> <a id="16197" class="Symbol">∀</a> <a id="16199" class="Symbol">{</a><a id="16200" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16200" class="Bound">Γ</a> <a id="16202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16202" class="Bound">Δ</a><a id="16203" class="Symbol">}</a> <a id="16205" class="Symbol">{</a><a id="16206" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16206" class="Bound">δ</a> <a id="16208" class="Symbol">:</a> <a id="16210" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="16214" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16202" class="Bound">Δ</a><a id="16215" class="Symbol">}</a> <a id="16217" class="Symbol">{</a><a id="16218" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16218" class="Bound">M</a> <a id="16220" class="Symbol">:</a> <a id="16222" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16200" class="Bound">Γ</a> <a id="16224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="16226" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="16227" class="Symbol">}</a> <a id="16229" class="Symbol">{</a><a id="16230" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16230" class="Bound">v</a><a id="16231" class="Symbol">}</a> <a id="16233" class="Symbol">{</a><a id="16234" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16234" class="Bound">L</a> <a id="16236" class="Symbol">:</a> <a id="16238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16202" class="Bound">Δ</a> <a id="16240" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="16242" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="16243" class="Symbol">}</a> <a id="16245" class="Symbol">{</a><a id="16246" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16246" class="Bound">σ</a> <a id="16248" class="Symbol">:</a> <a id="16250" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Substitution.md %}{% raw %}#2488" class="Function">Subst</a> <a id="16256" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16200" class="Bound">Γ</a> <a id="16258" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16202" class="Bound">Δ</a><a id="16259" class="Symbol">}</a>
  <a id="16263" class="Symbol">→</a> <a id="16265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16206" class="Bound">δ</a> <a id="16267" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="16269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16234" class="Bound">L</a> <a id="16271" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="16273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16230" class="Bound">v</a>
  <a id="16277" class="Symbol">→</a> <a id="16279" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6931" class="Function">subst</a> <a id="16285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16246" class="Bound">σ</a> <a id="16287" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16218" class="Bound">M</a> <a id="16289" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="16291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16234" class="Bound">L</a>
    <a id="16297" class="Comment">---------------------------------------</a>
  <a id="16339" class="Symbol">→</a> <a id="16341" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">Σ[</a> <a id="16344" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16344" class="Bound">γ</a> <a id="16346" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">∈</a> <a id="16348" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="16352" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16200" class="Bound">Γ</a> <a id="16354" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">]</a> <a id="16356" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16206" class="Bound">δ</a> <a id="16358" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="16361" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16246" class="Bound">σ</a> <a id="16363" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="16365" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16344" class="Bound">γ</a>  <a id="16368" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#1353" class="Function Operator">×</a>  <a id="16371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16344" class="Bound">γ</a> <a id="16373" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="16375" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16218" class="Bound">M</a> <a id="16377" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="16379" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16230" class="Bound">v</a>

<a id="16382" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16396" class="Symbol">{</a><a id="16397" class="Argument">M</a> <a id="16399" class="Symbol">=</a> <a id="16401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16401" class="Bound">M</a><a id="16402" class="Symbol">}{</a><a id="16404" class="Argument">σ</a> <a id="16406" class="Symbol">=</a> <a id="16408" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16408" class="Bound">σ</a><a id="16409" class="Symbol">}</a> <a id="16411" class="Symbol">(</a><a id="16412" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="16416" class="Symbol">{</a><a id="16417" class="Argument">x</a> <a id="16419" class="Symbol">=</a> <a id="16421" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16421" class="Bound">y</a><a id="16422" class="Symbol">})</a> <a id="16425" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16425" class="Bound">eqL</a> <a id="16429" class="Keyword">with</a> <a id="16434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16401" class="Bound">M</a> 
<a id="16437" class="Symbol">...</a> <a id="16441" class="Symbol">|</a> <a id="16443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="16445" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16445" class="Bound">x</a>  <a id="16448" class="Keyword">with</a> <a id="16453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="16457" class="Symbol">{</a><a id="16458" class="Argument">x</a> <a id="16460" class="Symbol">=</a> <a id="16462" class="Bound">y</a><a id="16463" class="Symbol">}</a>
<a id="16465" class="Symbol">...</a>           <a id="16479" class="Symbol">|</a> <a id="16481" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16481" class="Bound">yv</a>  <a id="16485" class="Keyword">rewrite</a> <a id="16493" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="16497" class="Bound">eqL</a> <a id="16501" class="Symbol">=</a> <a id="16503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14232" class="Function">subst-reflect-var</a> <a id="16521" class="Symbol">{</a><a id="16522" class="Argument">σ</a> <a id="16524" class="Symbol">=</a> <a id="16526" class="Bound">σ</a><a id="16527" class="Symbol">}</a> <a id="16529" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16481" class="Bound">yv</a>
<a id="16532" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16546" class="Symbol">{</a><a id="16547" class="Argument">M</a> <a id="16549" class="Symbol">=</a> <a id="16551" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16551" class="Bound">M</a><a id="16552" class="Symbol">}</a> <a id="16554" class="Symbol">(</a><a id="16555" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="16559" class="Symbol">{</a><a id="16560" class="Argument">x</a> <a id="16562" class="Symbol">=</a> <a id="16564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16564" class="Bound">y</a><a id="16565" class="Symbol">})</a> <a id="16568" class="Symbol">()</a> <a id="16571" class="Symbol">|</a> <a id="16573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16573" class="Bound">M₁</a> <a id="16576" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="16578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16578" class="Bound">M₂</a>
<a id="16581" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16595" class="Symbol">{</a><a id="16596" class="Argument">M</a> <a id="16598" class="Symbol">=</a> <a id="16600" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16600" class="Bound">M</a><a id="16601" class="Symbol">}</a> <a id="16603" class="Symbol">(</a><a id="16604" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="16608" class="Symbol">{</a><a id="16609" class="Argument">x</a> <a id="16611" class="Symbol">=</a> <a id="16613" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16613" class="Bound">y</a><a id="16614" class="Symbol">})</a> <a id="16617" class="Symbol">()</a> <a id="16620" class="Symbol">|</a> <a id="16622" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16624" class="Bound">M′</a>

<a id="16628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16642" class="Symbol">{</a><a id="16643" class="Argument">M</a> <a id="16645" class="Symbol">=</a> <a id="16647" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16647" class="Bound">M</a><a id="16648" class="Symbol">}{</a><a id="16650" class="Argument">σ</a> <a id="16652" class="Symbol">=</a> <a id="16654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16654" class="Bound">σ</a><a id="16655" class="Symbol">}</a> <a id="16657" class="Symbol">(</a><a id="16658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="16665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16665" class="Bound">d₁</a> <a id="16668" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16668" class="Bound">d₂</a><a id="16670" class="Symbol">)</a> <a id="16672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16672" class="Bound">eqL</a>
         <a id="16685" class="Keyword">with</a> <a id="16690" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16647" class="Bound">M</a> 
<a id="16693" class="Symbol">...</a>    <a id="16700" class="Symbol">|</a> <a id="16702" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="16704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16704" class="Bound">x</a> <a id="16706" class="Keyword">with</a> <a id="16711" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="16718" class="Bound">d₁</a> <a id="16721" class="Bound">d₂</a> 
<a id="16725" class="Symbol">...</a>    <a id="16732" class="Symbol">|</a> <a id="16734" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16734" class="Bound">d′</a> <a id="16737" class="Keyword">rewrite</a> <a id="16745" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="16749" class="Bound">eqL</a> <a id="16753" class="Symbol">=</a> <a id="16755" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14232" class="Function">subst-reflect-var</a> <a id="16773" class="Symbol">{</a><a id="16774" class="Argument">σ</a> <a id="16776" class="Symbol">=</a> <a id="16778" class="Bound">σ</a><a id="16779" class="Symbol">}</a> <a id="16781" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16734" class="Bound">d′</a>
<a id="16784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16798" class="Symbol">(</a><a id="16799" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="16806" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16806" class="Bound">d₁</a> <a id="16809" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16809" class="Bound">d₂</a><a id="16811" class="Symbol">)</a> <a id="16813" class="Symbol">()</a> <a id="16816" class="Symbol">|</a> <a id="16818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="16820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16820" class="Bound">M′</a>
<a id="16823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a><a id="16836" class="Symbol">{</a><a id="16837" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16837" class="Bound">Γ</a><a id="16838" class="Symbol">}{</a><a id="16840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16840" class="Bound">Δ</a><a id="16841" class="Symbol">}{</a><a id="16843" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16843" class="Bound">γ</a><a id="16844" class="Symbol">}{</a><a id="16846" class="Argument">σ</a> <a id="16848" class="Symbol">=</a> <a id="16850" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16850" class="Bound">σ</a><a id="16851" class="Symbol">}</a> <a id="16853" class="Symbol">(</a><a id="16854" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="16861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16861" class="Bound">d₁</a> <a id="16864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16864" class="Bound">d₂</a><a id="16866" class="Symbol">)</a>
   <a id="16871" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="16876" class="Symbol">|</a> <a id="16878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16878" class="Bound">M₁</a> <a id="16881" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="16883" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16883" class="Bound">M₂</a>
     <a id="16891" class="Keyword">with</a> <a id="16896" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16910" class="Symbol">{</a><a id="16911" class="Argument">M</a> <a id="16913" class="Symbol">=</a> <a id="16915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16878" class="Bound">M₁</a><a id="16917" class="Symbol">}</a> <a id="16919" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16861" class="Bound">d₁</a> <a id="16922" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="16927" class="Symbol">|</a> <a id="16929" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="16943" class="Symbol">{</a><a id="16944" class="Argument">M</a> <a id="16946" class="Symbol">=</a> <a id="16948" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16883" class="Bound">M₂</a><a id="16950" class="Symbol">}</a> <a id="16952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16864" class="Bound">d₂</a> <a id="16955" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="16960" class="Symbol">...</a>     <a id="16968" class="Symbol">|</a> <a id="16970" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="16972" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16972" class="Bound">δ₁</a> <a id="16975" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="16977" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="16979" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16979" class="Bound">subst-δ₁</a> <a id="16988" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="16990" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16990" class="Bound">m1</a> <a id="16993" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="16995" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="16997" class="Symbol">|</a> <a id="16999" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17001" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17001" class="Bound">δ₂</a> <a id="17004" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17006" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17008" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17008" class="Bound">subst-δ₂</a> <a id="17017" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17019" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17019" class="Bound">m2</a> <a id="17022" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17024" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17026" class="Symbol">=</a>
     <a id="17033" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16972" class="Bound">δ₁</a> <a id="17038" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8497" class="Function Operator">`⊔</a> <a id="17041" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17001" class="Bound">δ₂</a> <a id="17044" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17046" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17048" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15158" class="Function">subst-⊔</a> <a id="17056" class="Symbol">{</a><a id="17057" class="Argument">γ₁</a> <a id="17060" class="Symbol">=</a> <a id="17062" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16972" class="Bound">δ₁</a><a id="17064" class="Symbol">}{</a><a id="17066" class="Argument">γ₂</a> <a id="17069" class="Symbol">=</a> <a id="17071" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17001" class="Bound">δ₂</a><a id="17073" class="Symbol">}{</a><a id="17075" class="Argument">σ</a> <a id="17077" class="Symbol">=</a> <a id="17079" class="Bound">σ</a><a id="17080" class="Symbol">}</a> <a id="17082" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16979" class="Bound">subst-δ₁</a> <a id="17091" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17008" class="Bound">subst-δ₂</a> <a id="17100" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a>
                    <a id="17122" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="17129" class="Symbol">(</a><a id="17130" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a> <a id="17135" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16990" class="Bound">m1</a> <a id="17138" class="Symbol">(</a><a id="17139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8835" class="Function">EnvConjR1⊑</a> <a id="17150" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16972" class="Bound">δ₁</a> <a id="17153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17001" class="Bound">δ₂</a><a id="17155" class="Symbol">))</a>
                           <a id="17185" class="Symbol">(</a><a id="17186" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a> <a id="17191" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17019" class="Bound">m2</a> <a id="17194" class="Symbol">(</a><a id="17195" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8932" class="Function">EnvConjR2⊑</a> <a id="17206" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16972" class="Bound">δ₁</a> <a id="17209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17001" class="Bound">δ₂</a><a id="17211" class="Symbol">))</a> <a id="17214" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17216" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>

<a id="17219" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17233" class="Symbol">{</a><a id="17234" class="Argument">M</a> <a id="17236" class="Symbol">=</a> <a id="17238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17238" class="Bound">M</a><a id="17239" class="Symbol">}{</a><a id="17241" class="Argument">σ</a> <a id="17243" class="Symbol">=</a> <a id="17245" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17245" class="Bound">σ</a><a id="17246" class="Symbol">}</a> <a id="17248" class="Symbol">(</a><a id="17249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="17257" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17257" class="Bound">d</a><a id="17258" class="Symbol">)</a> <a id="17260" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17260" class="Bound">eqL</a> <a id="17264" class="Keyword">with</a> <a id="17269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17238" class="Bound">M</a>
<a id="17271" class="Symbol">...</a>    <a id="17278" class="Symbol">|</a> <a id="17280" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4186" class="InductiveConstructor Operator">`</a> <a id="17282" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17282" class="Bound">x</a> <a id="17284" class="Keyword">with</a> <a id="17289" class="Symbol">(</a><a id="17290" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="17298" class="Bound">d</a><a id="17299" class="Symbol">)</a>
<a id="17301" class="Symbol">...</a>             <a id="17317" class="Symbol">|</a> <a id="17319" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17319" class="Bound">d′</a> <a id="17322" class="Keyword">rewrite</a> <a id="17330" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="17334" class="Bound">eqL</a> <a id="17338" class="Symbol">=</a> <a id="17340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14232" class="Function">subst-reflect-var</a> <a id="17358" class="Symbol">{</a><a id="17359" class="Argument">σ</a> <a id="17361" class="Symbol">=</a> <a id="17363" class="Bound">σ</a><a id="17364" class="Symbol">}</a> <a id="17366" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17319" class="Bound">d′</a>
<a id="17369" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17383" class="Symbol">{</a><a id="17384" class="Argument">σ</a> <a id="17386" class="Symbol">=</a> <a id="17388" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17388" class="Bound">σ</a><a id="17389" class="Symbol">}</a> <a id="17391" class="Symbol">(</a><a id="17392" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="17400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17400" class="Bound">d</a><a id="17401" class="Symbol">)</a> <a id="17403" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17403" class="Bound">eq</a> <a id="17406" class="Symbol">|</a> <a id="17408" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="17410" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17410" class="Bound">M′</a>
      <a id="17419" class="Keyword">with</a> <a id="17424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17438" class="Symbol">{</a><a id="17439" class="Argument">σ</a> <a id="17441" class="Symbol">=</a> <a id="17443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#6623" class="Function">exts</a> <a id="17448" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17388" class="Bound">σ</a><a id="17449" class="Symbol">}</a> <a id="17451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17400" class="Bound">d</a> <a id="17453" class="Symbol">(</a><a id="17454" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15456" class="Function">lambda-inj</a> <a id="17465" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17403" class="Bound">eq</a><a id="17467" class="Symbol">)</a>
<a id="17469" class="Symbol">...</a> <a id="17473" class="Symbol">|</a> <a id="17475" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17477" class="Bound">δ′</a> <a id="17480" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17482" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17484" class="Bound">exts-σ-δ′</a> <a id="17494" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17496" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17496" class="Bound">m′</a> <a id="17499" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17501" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17503" class="Symbol">=</a> 
    <a id="17510" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17512" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7649" class="Function">init</a> <a id="17517" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17477" class="Bound">δ′</a> <a id="17520" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17522" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17524" class="Symbol">((λ</a> <a id="17528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17528" class="Bound">x</a> <a id="17530" class="Symbol">→</a> <a id="17532" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#11370" class="Function">rename-inc-reflect</a> <a id="17551" class="Symbol">(</a><a id="17552" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17484" class="Bound">exts-σ-δ′</a> <a id="17562" class="Symbol">(</a><a id="17563" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="17565" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17528" class="Bound">x</a><a id="17566" class="Symbol">))))</a> <a id="17571" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a>
             <a id="17586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="17594" class="Symbol">(</a><a id="17595" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26910" class="Function">up-env</a> <a id="17602" class="Symbol">(</a><a id="17603" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16008" class="Function">split</a> <a id="17609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17496" class="Bound">m′</a><a id="17611" class="Symbol">)</a> <a id="17613" class="Symbol">(</a><a id="17614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9327" class="Function">var-inv</a> <a id="17622" class="Symbol">(</a><a id="17623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17484" class="Bound">exts-σ-δ′</a> <a id="17633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a><a id="17634" class="Symbol">)))</a> <a id="17638" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17640" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="17642" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17656" class="Symbol">(</a><a id="17657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="17665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17665" class="Bound">d</a><a id="17666" class="Symbol">)</a> <a id="17668" class="Symbol">()</a> <a id="17671" class="Symbol">|</a> <a id="17673" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17673" class="Bound">M₁</a> <a id="17676" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="17678" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17678" class="Bound">M₂</a> 

<a id="17683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17697" class="Symbol">{</a><a id="17698" class="Argument">σ</a> <a id="17700" class="Symbol">=</a> <a id="17702" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17702" class="Bound">σ</a><a id="17703" class="Symbol">}</a> <a id="17705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="17713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17713" class="Bound">eq</a> <a id="17716" class="Symbol">=</a>
    <a id="17722" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17724" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8468" class="Function">`⊥</a> <a id="17727" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17729" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17731" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#14887" class="Function">subst-⊥</a> <a id="17739" class="Symbol">{</a><a id="17740" class="Argument">σ</a> <a id="17742" class="Symbol">=</a> <a id="17744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17702" class="Bound">σ</a><a id="17745" class="Symbol">}</a> <a id="17747" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17749" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="17757" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17759" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>

<a id="17762" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17776" class="Symbol">{</a><a id="17777" class="Argument">σ</a> <a id="17779" class="Symbol">=</a> <a id="17781" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17781" class="Bound">σ</a><a id="17782" class="Symbol">}</a> <a id="17784" class="Symbol">(</a><a id="17785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="17793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17793" class="Bound">d₁</a> <a id="17796" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17796" class="Bound">d₂</a><a id="17798" class="Symbol">)</a> <a id="17800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17800" class="Bound">eq</a>
  <a id="17805" class="Keyword">with</a> <a id="17810" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17824" class="Symbol">{</a><a id="17825" class="Argument">σ</a> <a id="17827" class="Symbol">=</a> <a id="17829" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17781" class="Bound">σ</a><a id="17830" class="Symbol">}</a> <a id="17832" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17793" class="Bound">d₁</a> <a id="17835" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17800" class="Bound">eq</a> <a id="17838" class="Symbol">|</a> <a id="17840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="17854" class="Symbol">{</a><a id="17855" class="Argument">σ</a> <a id="17857" class="Symbol">=</a> <a id="17859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17781" class="Bound">σ</a><a id="17860" class="Symbol">}</a> <a id="17862" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17796" class="Bound">d₂</a> <a id="17865" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17800" class="Bound">eq</a>
<a id="17868" class="Symbol">...</a> <a id="17872" class="Symbol">|</a> <a id="17874" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17876" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17876" class="Bound">δ₁</a> <a id="17879" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17881" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17883" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17883" class="Bound">subst-δ₁</a> <a id="17892" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17894" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17894" class="Bound">m1</a> <a id="17897" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17899" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17901" class="Symbol">|</a> <a id="17903" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17905" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17905" class="Bound">δ₂</a> <a id="17908" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17910" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17912" class="Bound">subst-δ₂</a> <a id="17921" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17923" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17923" class="Bound">m2</a> <a id="17926" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17928" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="17930" class="Symbol">=</a>
     <a id="17937" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17939" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17876" class="Bound">δ₁</a> <a id="17942" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8497" class="Function Operator">`⊔</a> <a id="17945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17905" class="Bound">δ₂</a> <a id="17948" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="17950" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="17952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#15158" class="Function">subst-⊔</a> <a id="17960" class="Symbol">{</a><a id="17961" class="Argument">γ₁</a> <a id="17964" class="Symbol">=</a> <a id="17966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17876" class="Bound">δ₁</a><a id="17968" class="Symbol">}{</a><a id="17970" class="Argument">γ₂</a> <a id="17973" class="Symbol">=</a> <a id="17975" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17905" class="Bound">δ₂</a><a id="17977" class="Symbol">}{</a><a id="17979" class="Argument">σ</a> <a id="17981" class="Symbol">=</a> <a id="17983" class="Bound">σ</a><a id="17984" class="Symbol">}</a> <a id="17986" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17883" class="Bound">subst-δ₁</a> <a id="17995" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17912" class="Bound">subst-δ₂</a> <a id="18004" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a>
                    <a id="18026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="18034" class="Symbol">(</a><a id="18035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a> <a id="18040" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17894" class="Bound">m1</a> <a id="18043" class="Symbol">(</a><a id="18044" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8835" class="Function">EnvConjR1⊑</a> <a id="18055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17876" class="Bound">δ₁</a> <a id="18058" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17905" class="Bound">δ₂</a><a id="18060" class="Symbol">))</a>
                            <a id="18091" class="Symbol">(</a><a id="18092" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a> <a id="18097" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17923" class="Bound">m2</a> <a id="18100" class="Symbol">(</a><a id="18101" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8932" class="Function">EnvConjR2⊑</a> <a id="18112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17876" class="Bound">δ₁</a> <a id="18115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#17905" class="Bound">δ₂</a><a id="18117" class="Symbol">))</a> <a id="18120" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="18122" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="18124" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="18138" class="Symbol">(</a><a id="18139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="18143" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18143" class="Bound">d</a> <a id="18145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18145" class="Bound">lt</a><a id="18147" class="Symbol">)</a> <a id="18149" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18149" class="Bound">eq</a> 
    <a id="18157" class="Keyword">with</a> <a id="18162" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="18176" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18143" class="Bound">d</a> <a id="18178" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18149" class="Bound">eq</a>
<a id="18181" class="Symbol">...</a> <a id="18185" class="Symbol">|</a> <a id="18187" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="18189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18189" class="Bound">δ</a> <a id="18191" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="18193" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="18195" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18195" class="Bound">subst-δ</a> <a id="18203" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="18205" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18205" class="Bound">m</a> <a id="18207" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="18209" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="18211" class="Symbol">=</a> <a id="18213" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="18215" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18189" class="Bound">δ</a> <a id="18217" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="18219" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="18221" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18195" class="Bound">subst-δ</a> <a id="18229" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="18231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="18235" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#18205" class="Bound">m</a> <a id="18237" class="Bound">lt</a> <a id="18240" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="18242" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>

* Case `var`: We have subst `σ M ≡ y`, so `M` must also be a variable, say `x`.
  We apply the lemma `subst-reflect-var` to conclude.

* Case `↦-elim`: We have `subst σ M ≡ L₁ · L₂`. We proceed by cases on `M`.
  * Case `M ≡ x`: We apply the `subst-reflect-var` lemma again to conclude.

  * Case `M ≡ M₁ · M₂`: By the induction hypothesis, we have
    some `δ₁` and `δ₂` such that `δ₁ ⊢ M₁ ↓ v₁ ↦ v₃` and `γ ⊢ σ ↓ δ₁`,
    as well as `δ₂ ⊢ M₂ ↓ v₁` and `γ ⊢ σ ↓ δ₂`.
    By `Env⊑` we have `δ₁ ⊔ δ₂ ⊢ M₁ ↓ v₁ ↦ v₃` and `δ₁ ⊔ δ₂ ⊢ M₂ ↓ v₁`
    (using `EnvConjR1⊑` and `EnvConjR2⊑`), and therefore
    `δ₁ ⊔ δ₂ ⊢ M₁ · M₂ ↓ v₃`.
    We conclude this case by obtaining `γ ⊢ σ ↓ δ₁ ⊔ δ₂`
    by the `subst-⊔` lemma.

* Case `↦-intro`: We have `subst σ M ≡ ƛ L′`. We proceed by cases on `M`.
  * Case `M ≡ x`: We apply the `subst-reflect-var` lemma.

  * Case `M ≡ ƛ M′`: By the induction hypothesis, we have
    `(δ′ , v′) ⊢ M′ ↓ v₂` and `(δ , v₁) ⊢ exts σ ↓ (δ′ , v′)`.
    From the later we have `(δ , v₁) ⊢ # 0 ↓ v′`.
    By the lemma `var-inv` we have `v′ ⊑ v₁`, so by the `up-env` lemma we
    have `(δ′ , v₁) ⊢ M′ ↓ v₂` and therefore `δ′ ⊢ ƛ M′ ↓ v₁ → v₂`.  We
    also need to show that `δ `⊢ σ ↓ δ′`.  Fix `k`. We have
    `(δ , v₁) ⊢ rename S_ σ k ↓ nth k δ′`.  We then apply the lemma
    `rename-inc-reflect` to obtain `δ ⊢ σ k ↓ nth k δ′`, so this case is
    complete.

* Case `⊥-intro`: We choose `⊥` for `δ`.
  We have `⊥ ⊢ M ↓ ⊥` by `⊥-intro`.
  We have `δ ⊢ σ ↓ ⊥` by the lemma `subst-empty`.

* Case `⊔-intro`: By the induction hypothesis we have
  `δ₁ ⊢ M ↓ v₁`, `δ₂ ⊢ M ↓ v₂`, `δ ⊢ σ ↓ δ₁`, and `δ ⊢ σ ↓ δ₂`.
  We have `δ₁ ⊔ δ₂ ⊢ M ↓ v₁` and `δ₁ ⊔ δ₂ ⊢ M ↓ v₂`
  by `Env⊑` with `EnvConjR1⊑` and `EnvConjR2⊑`.
  So by `⊔-intro` we have `δ₁ ⊔ δ₂ ⊢ M ↓ v₁ ⊔ v₂`.
  By `subst-⊔` we conclude that `δ ⊢ σ ↓ δ₁ ⊔ δ₂`.
   

### Single substitution reflects denotations

Most of the work is now behind us. We have proved that simultaneous
substitution reflects denotations. Of course, β reduction uses single
substitution, so we need a corollary that proves that single
substitution reflects denotations. That is,
give terms `N : (Γ , ★ ⊢ ★)` and `M : (Γ ⊢ ★)`,
if `γ ⊢ N [ M ] ↓ w`, then `γ ⊢ M ↓ v` and `(γ , v) ⊢ N ↓ w`
for some value `v`. We have `N [ M ] = subst (subst-zero M) N`.
We apply the `subst-reflect` lemma to obtain
`γ ⊢ subst-zero M ↓ (δ′ , v′)` and `(δ′ , v′) ⊢ N ↓ w`
for some `δ′` and `v′`.

Instantiating `γ ⊢ subst-zero M ↓ (δ′ , v′)` at `k = 0`
gives us `γ ⊢ M ↓ v′`. We choose `w = v′`, so the first
part of our conclusion is complete.

It remains to prove `(γ , v′) ⊢ N ↓ v`. First, we obtain 
`(γ , v′) ⊢ rename var-id N ↓ v` by the `rename-pres` lemma
applied to `(δ′ , v′) ⊢ N ↓ v`, with the `var-id` renaming,
`γ = (δ′ , v′)`, and `δ = (γ , v′)`. To apply this lemma,
we need to show that 
`nth n (δ′ , v′) ⊑ nth (var-id n) (γ , v′)` for any `n`.
This is accomplished by the following lemma, which
makes use of `γ ⊢ subst-zero M ↓ (δ′ , v′)`.

<pre class="Agda">{% raw %}<a id="nth-id-le"></a><a id="21248" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21248" class="Function">nth-id-le</a> <a id="21258" class="Symbol">:</a> <a id="21260" class="Symbol">∀{</a><a id="21262" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21262" class="Bound">Γ</a><a id="21263" class="Symbol">}{</a><a id="21265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21265" class="Bound">δ′</a><a id="21267" class="Symbol">}{</a><a id="21269" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21269" class="Bound">v′</a><a id="21271" class="Symbol">}{</a><a id="21273" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21273" class="Bound">γ</a><a id="21274" class="Symbol">}{</a><a id="21276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21276" class="Bound">M</a><a id="21277" class="Symbol">}</a>
      <a id="21285" class="Symbol">→</a> <a id="21287" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21273" class="Bound">γ</a> <a id="21289" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="21292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7359" class="Function">subst-zero</a> <a id="21303" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21276" class="Bound">M</a> <a id="21305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="21307" class="Symbol">(</a><a id="21308" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21265" class="Bound">δ′</a> <a id="21311" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="21314" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21269" class="Bound">v′</a><a id="21316" class="Symbol">)</a>
        <a id="21326" class="Comment">-----------------------------------------------------</a>
      <a id="21386" class="Symbol">→</a> <a id="21388" class="Symbol">(</a><a id="21389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21389" class="Bound">x</a> <a id="21391" class="Symbol">:</a> <a id="21393" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21262" class="Bound">Γ</a> <a id="21395" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="21397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="21399" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3365" class="Datatype Operator">∋</a> <a id="21401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="21402" class="Symbol">)</a> <a id="21404" class="Symbol">→</a> <a id="21406" class="Symbol">(</a><a id="21407" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21265" class="Bound">δ′</a> <a id="21410" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="21413" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21269" class="Bound">v′</a><a id="21415" class="Symbol">)</a> <a id="21417" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21389" class="Bound">x</a> <a id="21419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#4360" class="Datatype Operator">⊑</a> <a id="21421" class="Symbol">(</a><a id="21422" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21273" class="Bound">γ</a> <a id="21424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="21427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21269" class="Bound">v′</a><a id="21429" class="Symbol">)</a> <a id="21431" class="Symbol">(</a><a id="21432" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26128" class="Function">var-id</a> <a id="21439" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21389" class="Bound">x</a><a id="21440" class="Symbol">)</a> 
<a id="21443" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21248" class="Function">nth-id-le</a> <a id="21453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21453" class="Bound">γ-sz-δ′v′</a> <a id="21463" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="21465" class="Symbol">=</a> <a id="21467" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5530" class="Function">Refl⊑</a>
<a id="21473" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21248" class="Function">nth-id-le</a> <a id="21483" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21483" class="Bound">γ-sz-δ′v′</a> <a id="21493" class="Symbol">(</a><a id="21494" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="21496" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21496" class="Bound">n′</a><a id="21498" class="Symbol">)</a> <a id="21500" class="Symbol">=</a> <a id="21502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9327" class="Function">var-inv</a> <a id="21510" class="Symbol">(</a><a id="21511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21483" class="Bound">γ-sz-δ′v′</a> <a id="21521" class="Symbol">(</a><a id="21522" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="21524" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#21496" class="Bound">n′</a><a id="21526" class="Symbol">))</a>{% endraw %}</pre>

The above lemma proceeds by induction on `n`.

* If it is `Z`, then we show that `v′ ⊑ v′` by `Refl⊑`.
* If it is `S n′`, then from the premise we obtain
  `γ ⊢ # n′ ↓ nth n′ δ′`. By `var-inv` we have
  `nth n′ δ′ ⊑ nth n′ γ` from which we conclude that
  `nth (S n′) (δ′ , v′) ⊑ nth (var-id (S n′)) (γ , v′)`.

Returning to the proof that single substitution reflects
denotations, we have just proved that

  (γ `, v′) ⊢ rename var-id N ↓ v

but we need to show `(γ `, v′) ⊢ N ↓ v`.
So we apply the `rename-id` lemma to obtain
`rename var-id N ≡ N`.

The following is the formal version of this proof.

<pre class="Agda">{% raw %}<a id="subst-zero-reflect"></a><a id="22158" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22158" class="Function">subst-zero-reflect</a> <a id="22177" class="Symbol">:</a> <a id="22179" class="Symbol">∀</a> <a id="22181" class="Symbol">{</a><a id="22182" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22182" class="Bound">Δ</a><a id="22183" class="Symbol">}</a> <a id="22185" class="Symbol">{</a><a id="22186" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22186" class="Bound">δ</a> <a id="22188" class="Symbol">:</a> <a id="22190" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="22194" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22182" class="Bound">Δ</a><a id="22195" class="Symbol">}</a> <a id="22197" class="Symbol">{</a><a id="22198" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22198" class="Bound">γ</a> <a id="22200" class="Symbol">:</a> <a id="22202" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="22206" class="Symbol">(</a><a id="22207" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22182" class="Bound">Δ</a> <a id="22209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="22211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="22212" class="Symbol">)}</a> <a id="22215" class="Symbol">{</a><a id="22216" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22216" class="Bound">M</a> <a id="22218" class="Symbol">:</a> <a id="22220" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22182" class="Bound">Δ</a> <a id="22222" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="22224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="22225" class="Symbol">}</a>
  <a id="22229" class="Symbol">→</a> <a id="22231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22186" class="Bound">δ</a> <a id="22233" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">`⊢</a> <a id="22236" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7359" class="Function">subst-zero</a> <a id="22247" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22216" class="Bound">M</a> <a id="22249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#3260" class="Function Operator">↓</a> <a id="22251" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22198" class="Bound">γ</a>
    <a id="22257" class="Comment">----------------------------------------</a>
  <a id="22300" class="Symbol">→</a> <a id="22302" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">Σ[</a> <a id="22305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22305" class="Bound">w</a> <a id="22307" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">∈</a> <a id="22309" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#3989" class="Datatype">Value</a> <a id="22315" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">]</a> <a id="22317" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22198" class="Bound">γ</a> <a id="22319" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">`⊑</a> <a id="22322" class="Symbol">(</a><a id="22323" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22186" class="Bound">δ</a> <a id="22325" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="22328" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22305" class="Bound">w</a><a id="22329" class="Symbol">)</a> <a id="22331" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#1353" class="Function Operator">×</a> <a id="22333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22186" class="Bound">δ</a> <a id="22335" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="22337" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22216" class="Bound">M</a> <a id="22339" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="22341" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22305" class="Bound">w</a>
<a id="22343" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22158" class="Function">subst-zero-reflect</a> <a id="22362" class="Symbol">{</a><a id="22363" class="Argument">δ</a> <a id="22365" class="Symbol">=</a> <a id="22367" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22367" class="Bound">δ</a><a id="22368" class="Symbol">}</a> <a id="22370" class="Symbol">{</a><a id="22371" class="Argument">γ</a> <a id="22373" class="Symbol">=</a> <a id="22375" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22375" class="Bound">γ</a><a id="22376" class="Symbol">}</a> <a id="22378" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22378" class="Bound">δσγ</a> <a id="22382" class="Symbol">=</a> <a id="22384" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22386" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7704" class="Function">last</a> <a id="22391" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22375" class="Bound">γ</a> <a id="22393" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22395" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22428" class="Function">lemma</a> <a id="22403" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22405" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22378" class="Bound">δσγ</a> <a id="22409" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a> <a id="22411" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22413" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>   
  <a id="22420" class="Keyword">where</a>
  <a id="22428" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22428" class="Function">lemma</a> <a id="22434" class="Symbol">:</a> <a id="22436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22375" class="Bound">γ</a> <a id="22438" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#8249" class="Function Operator">`⊑</a> <a id="22441" class="Symbol">(</a><a id="22442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22367" class="Bound">δ</a> <a id="22444" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="22447" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7704" class="Function">last</a> <a id="22452" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22375" class="Bound">γ</a><a id="22453" class="Symbol">)</a>
  <a id="22457" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22428" class="Function">lemma</a> <a id="22463" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3401" class="InductiveConstructor">Z</a>  <a id="22466" class="Symbol">=</a>  <a id="22469" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#5530" class="Function">Refl⊑</a>
  <a id="22477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22428" class="Function">lemma</a> <a id="22483" class="Symbol">(</a><a id="22484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="22486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22486" class="Bound">x</a><a id="22487" class="Symbol">)</a> <a id="22489" class="Symbol">=</a> <a id="22491" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Compositional.md %}{% raw %}#9327" class="Function">var-inv</a> <a id="22499" class="Symbol">(</a><a id="22500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22378" class="Bound">δσγ</a> <a id="22504" class="Symbol">(</a><a id="22505" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3446" class="InductiveConstructor Operator">S</a> <a id="22507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22486" class="Bound">x</a><a id="22508" class="Symbol">))</a>
  
<a id="substitution-reflect"></a><a id="22514" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22514" class="Function">substitution-reflect</a> <a id="22535" class="Symbol">:</a> <a id="22537" class="Symbol">∀</a> <a id="22539" class="Symbol">{</a><a id="22540" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22540" class="Bound">Δ</a><a id="22541" class="Symbol">}</a> <a id="22543" class="Symbol">{</a><a id="22544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22544" class="Bound">δ</a> <a id="22546" class="Symbol">:</a> <a id="22548" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="22552" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22540" class="Bound">Δ</a><a id="22553" class="Symbol">}</a> <a id="22555" class="Symbol">{</a><a id="22556" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22556" class="Bound">N</a> <a id="22558" class="Symbol">:</a> <a id="22560" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22540" class="Bound">Δ</a> <a id="22562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="22564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="22566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="22568" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="22569" class="Symbol">}</a> <a id="22571" class="Symbol">{</a><a id="22572" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22572" class="Bound">M</a> <a id="22574" class="Symbol">:</a> <a id="22576" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22540" class="Bound">Δ</a> <a id="22578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="22580" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="22581" class="Symbol">}</a> <a id="22583" class="Symbol">{</a><a id="22584" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22584" class="Bound">v</a><a id="22585" class="Symbol">}</a>
  <a id="22589" class="Symbol">→</a> <a id="22591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22544" class="Bound">δ</a> <a id="22593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="22595" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22556" class="Bound">N</a> <a id="22597" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">[</a> <a id="22599" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22572" class="Bound">M</a> <a id="22601" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">]</a> <a id="22603" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="22605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22584" class="Bound">v</a>
    <a id="22611" class="Comment">------------------------------------------------</a>
  <a id="22662" class="Symbol">→</a> <a id="22664" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">Σ[</a> <a id="22667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22667" class="Bound">w</a> <a id="22669" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">∈</a> <a id="22671" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#3989" class="Datatype">Value</a> <a id="22677" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#764" class="Function">]</a> <a id="22679" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22544" class="Bound">δ</a> <a id="22681" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="22683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22572" class="Bound">M</a> <a id="22685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="22687" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22667" class="Bound">w</a>  <a id="22690" href="https://agda.github.io/agda-stdlib/v0.17/Data.Product.html#1353" class="Function Operator">×</a>  <a id="22693" class="Symbol">(</a><a id="22694" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22544" class="Bound">δ</a> <a id="22696" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7396" class="Function Operator">`,</a> <a id="22699" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22667" class="Bound">w</a><a id="22700" class="Symbol">)</a> <a id="22702" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="22704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22556" class="Bound">N</a> <a id="22706" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="22708" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22584" class="Bound">v</a>
<a id="22710" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22514" class="Function">substitution-reflect</a> <a id="22731" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22731" class="Bound">d</a> <a id="22733" class="Keyword">with</a> <a id="22738" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#16181" class="Function">subst-reflect</a> <a id="22752" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22731" class="Bound">d</a> <a id="22754" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="22759" class="Symbol">...</a>  <a id="22764" class="Symbol">|</a> <a id="22766" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22768" class="Bound">γ</a> <a id="22770" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22772" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22774" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22774" class="Bound">δσγ</a> <a id="22778" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22780" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22780" class="Bound">γNv</a> <a id="22784" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22786" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22788" class="Keyword">with</a> <a id="22793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22158" class="Function">subst-zero-reflect</a> <a id="22812" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22774" class="Bound">δσγ</a>
<a id="22816" class="Symbol">...</a>    <a id="22823" class="Symbol">|</a> <a id="22825" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22827" class="Bound">w</a> <a id="22829" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22831" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22833" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22833" class="Bound">ineq</a> <a id="22838" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22840" class="Bound">δMw</a> <a id="22844" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22846" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22848" class="Symbol">=</a> <a id="22850" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22852" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22827" class="Bound">w</a> <a id="22854" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22856" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="22858" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22840" class="Bound">δMw</a> <a id="22862" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="22864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#26476" class="Function">Env⊑</a> <a id="22869" class="Bound">γNv</a> <a id="22873" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22833" class="Bound">ineq</a> <a id="22878" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="22880" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>


### Reduction reflects denotations

Now that we have proved that substitution reflects denotations, we can
easily prove that reduction does too.

<pre class="Agda">{% raw %}<a id="reflect-beta"></a><a id="23054" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23054" class="Function">reflect-beta</a> <a id="23067" class="Symbol">:</a> <a id="23069" class="Symbol">∀{</a><a id="23071" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23071" class="Bound">Γ</a><a id="23072" class="Symbol">}{</a><a id="23074" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23074" class="Bound">γ</a> <a id="23076" class="Symbol">:</a> <a id="23078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="23082" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23071" class="Bound">Γ</a><a id="23083" class="Symbol">}{</a><a id="23085" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23085" class="Bound">M</a> <a id="23087" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23087" class="Bound">N</a><a id="23088" class="Symbol">}{</a><a id="23090" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23090" class="Bound">v</a><a id="23091" class="Symbol">}</a>
    <a id="23097" class="Symbol">→</a> <a id="23099" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23074" class="Bound">γ</a> <a id="23101" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="23103" class="Symbol">(</a><a id="23104" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23087" class="Bound">N</a> <a id="23106" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">[</a> <a id="23108" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23085" class="Bound">M</a> <a id="23110" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#7475" class="Function Operator">]</a><a id="23111" class="Symbol">)</a> <a id="23113" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="23115" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23090" class="Bound">v</a>
    <a id="23121" class="Symbol">→</a> <a id="23123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23074" class="Bound">γ</a> <a id="23125" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="23127" class="Symbol">(</a><a id="23128" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="23130" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23087" class="Bound">N</a><a id="23131" class="Symbol">)</a> <a id="23133" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4298" class="InductiveConstructor Operator">·</a> <a id="23135" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23085" class="Bound">M</a> <a id="23137" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="23139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23090" class="Bound">v</a>
<a id="23141" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23054" class="Function">reflect-beta</a> <a id="23154" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23154" class="Bound">d</a> 
    <a id="23161" class="Keyword">with</a> <a id="23166" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#22514" class="Function">substitution-reflect</a> <a id="23187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23154" class="Bound">d</a>
<a id="23189" class="Symbol">...</a> <a id="23193" class="Symbol">|</a> <a id="23195" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="23197" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23197" class="Bound">v₂′</a> <a id="23201" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="23203" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="23205" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23205" class="Bound">d₁′</a> <a id="23209" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="23211" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23211" class="Bound">d₂′</a> <a id="23215" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="23217" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a> <a id="23219" class="Symbol">=</a> <a id="23221" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23228" class="Symbol">(</a><a id="23229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23237" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23211" class="Bound">d₂′</a><a id="23240" class="Symbol">)</a> <a id="23242" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23205" class="Bound">d₁′</a> 


<a id="reflect"></a><a id="23249" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23257" class="Symbol">:</a> <a id="23259" class="Symbol">∀</a> <a id="23261" class="Symbol">{</a><a id="23262" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23262" class="Bound">Γ</a><a id="23263" class="Symbol">}</a> <a id="23265" class="Symbol">{</a><a id="23266" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23266" class="Bound">γ</a> <a id="23268" class="Symbol">:</a> <a id="23270" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#7223" class="Function">Env</a> <a id="23274" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23262" class="Bound">Γ</a><a id="23275" class="Symbol">}</a> <a id="23277" class="Symbol">{</a><a id="23278" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23278" class="Bound">M</a> <a id="23280" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23280" class="Bound">M′</a> <a id="23283" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23283" class="Bound">N</a> <a id="23285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23285" class="Bound">v</a><a id="23286" class="Symbol">}</a>
  <a id="23290" class="Symbol">→</a> <a id="23292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23266" class="Bound">γ</a> <a id="23294" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="23296" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23283" class="Bound">N</a> <a id="23298" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="23300" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23285" class="Bound">v</a>  <a id="23303" class="Symbol">→</a>  <a id="23306" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23278" class="Bound">M</a> <a id="23308" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#386" class="Datatype Operator">—→</a> <a id="23311" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23280" class="Bound">M′</a>  <a id="23315" class="Symbol">→</a>   <a id="23319" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23280" class="Bound">M′</a> <a id="23322" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="23324" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23283" class="Bound">N</a>
    <a id="23330" class="Comment">---------------------------------</a>
  <a id="23366" class="Symbol">→</a> <a id="23368" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23266" class="Bound">γ</a> <a id="23370" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">⊢</a> <a id="23372" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23278" class="Bound">M</a> <a id="23374" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9509" class="Datatype Operator">↓</a> <a id="23376" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23285" class="Bound">v</a>
<a id="23378" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23386" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="23390" class="Symbol">(</a><a id="23391" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#436" class="InductiveConstructor">ξ₁</a> <a id="23394" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23394" class="Bound">r</a><a id="23395" class="Symbol">)</a> <a id="23397" class="Symbol">()</a>
<a id="23400" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23408" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="23412" class="Symbol">(</a><a id="23413" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#526" class="InductiveConstructor">ξ₂</a> <a id="23416" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23416" class="Bound">r</a><a id="23417" class="Symbol">)</a> <a id="23419" class="Symbol">()</a>
<a id="23422" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a><a id="23429" class="Symbol">{</a><a id="23430" class="Argument">γ</a> <a id="23432" class="Symbol">=</a> <a id="23434" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23434" class="Bound">γ</a><a id="23435" class="Symbol">}</a> <a id="23437" class="Symbol">(</a><a id="23438" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a><a id="23441" class="Symbol">{</a><a id="23442" class="Argument">x</a> <a id="23444" class="Symbol">=</a> <a id="23446" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23446" class="Bound">x</a><a id="23447" class="Symbol">})</a> <a id="23450" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#616" class="InductiveConstructor">β</a> <a id="23452" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23452" class="Bound">mn</a>
    <a id="23459" class="Keyword">with</a> <a id="23464" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a><a id="23467" class="Symbol">{</a><a id="23468" class="Argument">γ</a> <a id="23470" class="Symbol">=</a> <a id="23472" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23434" class="Bound">γ</a><a id="23473" class="Symbol">}{</a><a id="23475" class="Argument">x</a> <a id="23477" class="Symbol">=</a> <a id="23479" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23446" class="Bound">x</a><a id="23480" class="Symbol">}</a>
<a id="23482" class="Symbol">...</a> <a id="23486" class="Symbol">|</a> <a id="23488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23488" class="Bound">d′</a> <a id="23491" class="Keyword">rewrite</a> <a id="23499" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="23503" class="Bound">mn</a> <a id="23506" class="Symbol">=</a> <a id="23508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23054" class="Function">reflect-beta</a> <a id="23521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23488" class="Bound">d′</a> 
<a id="23525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9563" class="InductiveConstructor">var</a> <a id="23537" class="Symbol">(</a><a id="23538" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#724" class="InductiveConstructor">ζ</a> <a id="23540" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23540" class="Bound">r</a><a id="23541" class="Symbol">)</a> <a id="23543" class="Symbol">()</a>
<a id="23546" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23554" class="Symbol">(</a><a id="23555" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23562" class="Bound">d₁</a> <a id="23565" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23565" class="Bound">d₂</a><a id="23567" class="Symbol">)</a> <a id="23569" class="Symbol">(</a><a id="23570" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#436" class="InductiveConstructor">ξ₁</a> <a id="23573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23573" class="Bound">r</a><a id="23574" class="Symbol">)</a> <a id="23576" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="23581" class="Symbol">=</a> <a id="23583" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23590" class="Symbol">(</a><a id="23591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23599" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23562" class="Bound">d₁</a> <a id="23602" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23573" class="Bound">r</a> <a id="23604" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="23608" class="Symbol">)</a> <a id="23610" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23565" class="Bound">d₂</a> 
<a id="23614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23622" class="Symbol">(</a><a id="23623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23630" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23630" class="Bound">d₁</a> <a id="23633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23633" class="Bound">d₂</a><a id="23635" class="Symbol">)</a> <a id="23637" class="Symbol">(</a><a id="23638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#526" class="InductiveConstructor">ξ₂</a> <a id="23641" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23641" class="Bound">r</a><a id="23642" class="Symbol">)</a> <a id="23644" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="23649" class="Symbol">=</a> <a id="23651" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23630" class="Bound">d₁</a> <a id="23661" class="Symbol">(</a><a id="23662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23633" class="Bound">d₂</a> <a id="23673" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23641" class="Bound">r</a> <a id="23675" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="23679" class="Symbol">)</a> 
<a id="23682" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23690" class="Symbol">(</a><a id="23691" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23698" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23698" class="Bound">d₁</a> <a id="23701" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23701" class="Bound">d₂</a><a id="23703" class="Symbol">)</a> <a id="23705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#616" class="InductiveConstructor">β</a> <a id="23707" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23707" class="Bound">mn</a>
    <a id="23714" class="Keyword">with</a> <a id="23719" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23698" class="Bound">d₁</a> <a id="23729" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23701" class="Bound">d₂</a>
<a id="23732" class="Symbol">...</a> <a id="23736" class="Symbol">|</a> <a id="23738" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23738" class="Bound">d′</a> <a id="23741" class="Keyword">rewrite</a> <a id="23749" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="23753" class="Bound">mn</a> <a id="23756" class="Symbol">=</a> <a id="23758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23054" class="Function">reflect-beta</a> <a id="23771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23738" class="Bound">d′</a>
<a id="23774" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23782" class="Symbol">(</a><a id="23783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9642" class="InductiveConstructor">↦-elim</a> <a id="23790" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23790" class="Bound">d₁</a> <a id="23793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23793" class="Bound">d₂</a><a id="23795" class="Symbol">)</a> <a id="23797" class="Symbol">(</a><a id="23798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#724" class="InductiveConstructor">ζ</a> <a id="23800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23800" class="Bound">r</a><a id="23801" class="Symbol">)</a> <a id="23803" class="Symbol">()</a>
<a id="23806" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23814" class="Symbol">(</a><a id="23815" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23823" class="Bound">d</a><a id="23824" class="Symbol">)</a> <a id="23826" class="Symbol">(</a><a id="23827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#436" class="InductiveConstructor">ξ₁</a> <a id="23830" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23830" class="Bound">r</a><a id="23831" class="Symbol">)</a> <a id="23833" class="Symbol">()</a>
<a id="23836" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23844" class="Symbol">(</a><a id="23845" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23853" class="Bound">d</a><a id="23854" class="Symbol">)</a> <a id="23856" class="Symbol">(</a><a id="23857" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#526" class="InductiveConstructor">ξ₂</a> <a id="23860" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23860" class="Bound">r</a><a id="23861" class="Symbol">)</a> <a id="23863" class="Symbol">()</a>
<a id="23866" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23874" class="Symbol">(</a><a id="23875" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23883" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23883" class="Bound">d</a><a id="23884" class="Symbol">)</a> <a id="23886" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#616" class="InductiveConstructor">β</a> <a id="23888" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23888" class="Bound">mn</a>
    <a id="23895" class="Keyword">with</a> <a id="23900" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23908" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23883" class="Bound">d</a>
<a id="23910" class="Symbol">...</a> <a id="23914" class="Symbol">|</a> <a id="23916" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23916" class="Bound">d′</a> <a id="23919" class="Keyword">rewrite</a> <a id="23927" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="23931" class="Bound">mn</a> <a id="23934" class="Symbol">=</a> <a id="23936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23054" class="Function">reflect-beta</a> <a id="23949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23916" class="Bound">d′</a>
<a id="23952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="23960" class="Symbol">(</a><a id="23961" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23969" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23969" class="Bound">d</a><a id="23970" class="Symbol">)</a> <a id="23972" class="Symbol">(</a><a id="23973" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#724" class="InductiveConstructor">ζ</a> <a id="23975" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23975" class="Bound">r</a><a id="23976" class="Symbol">)</a> <a id="23978" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="23983" class="Symbol">=</a> <a id="23985" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9780" class="InductiveConstructor">↦-intro</a> <a id="23993" class="Symbol">(</a><a id="23994" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24002" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23969" class="Bound">d</a> <a id="24004" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23975" class="Bound">r</a> <a id="24006" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24010" class="Symbol">)</a>
<a id="24012" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24020" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a> <a id="24028" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24028" class="Bound">r</a> <a id="24030" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24030" class="Bound">mn</a> <a id="24033" class="Symbol">=</a> <a id="24035" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9904" class="InductiveConstructor">⊥-intro</a>
<a id="24043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24051" class="Symbol">(</a><a id="24052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="24060" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24060" class="Bound">d₁</a> <a id="24063" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24063" class="Bound">d₂</a><a id="24065" class="Symbol">)</a> <a id="24067" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24067" class="Bound">r</a> <a id="24069" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24069" class="Bound">mn</a> <a id="24072" class="Keyword">rewrite</a> <a id="24080" href="https://agda.github.io/agda-stdlib/v0.17/Relation.Binary.PropositionalEquality.Core.html#838" class="Function">sym</a> <a id="24084" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24069" class="Bound">mn</a> <a id="24087" class="Symbol">=</a>
   <a id="24092" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#9979" class="InductiveConstructor">⊔-intro</a> <a id="24100" class="Symbol">(</a><a id="24101" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24060" class="Bound">d₁</a> <a id="24112" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24067" class="Bound">r</a> <a id="24114" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24118" class="Symbol">)</a> <a id="24120" class="Symbol">(</a><a id="24121" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24063" class="Bound">d₂</a> <a id="24132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24067" class="Bound">r</a> <a id="24134" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24138" class="Symbol">)</a>
<a id="24140" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24148" class="Symbol">(</a><a id="24149" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="24153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24153" class="Bound">d</a> <a id="24155" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24155" class="Bound">lt</a><a id="24157" class="Symbol">)</a> <a id="24159" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24159" class="Bound">r</a> <a id="24161" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24161" class="Bound">mn</a> <a id="24164" class="Symbol">=</a> <a id="24166" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#10115" class="InductiveConstructor">sub</a> <a id="24170" class="Symbol">(</a><a id="24171" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24179" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24153" class="Bound">d</a> <a id="24181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24159" class="Bound">r</a> <a id="24183" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24161" class="Bound">mn</a><a id="24185" class="Symbol">)</a> <a id="24187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24155" class="Bound">lt</a>{% endraw %}</pre>

## Reduction implies denotational equality

We have proved that reduction both preserves and reflects
denotations. Thus, reduction implies denotational equality.

<pre class="Agda">{% raw %}<a id="reduce-equal"></a><a id="24379" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24379" class="Function">reduce-equal</a> <a id="24392" class="Symbol">:</a> <a id="24394" class="Symbol">∀</a> <a id="24396" class="Symbol">{</a><a id="24397" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24397" class="Bound">Γ</a><a id="24398" class="Symbol">}</a> <a id="24400" class="Symbol">{</a><a id="24401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24401" class="Bound">M</a> <a id="24403" class="Symbol">:</a> <a id="24405" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24397" class="Bound">Γ</a> <a id="24407" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="24409" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="24410" class="Symbol">}</a> <a id="24412" class="Symbol">{</a><a id="24413" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24413" class="Bound">N</a> <a id="24415" class="Symbol">:</a> <a id="24417" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24397" class="Bound">Γ</a> <a id="24419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="24421" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="24422" class="Symbol">}</a>
  <a id="24426" class="Symbol">→</a> <a id="24428" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24401" class="Bound">M</a> <a id="24430" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#386" class="Datatype Operator">—→</a> <a id="24433" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24413" class="Bound">N</a>
    <a id="24439" class="Comment">---------</a>
  <a id="24451" class="Symbol">→</a> <a id="24453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#17987" class="Function">ℰ</a> <a id="24455" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24401" class="Bound">M</a> <a id="24457" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18185" class="Function Operator">≃</a> <a id="24459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#17987" class="Function">ℰ</a> <a id="24461" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24413" class="Bound">N</a>
<a id="24463" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24379" class="Function">reduce-equal</a> <a id="24476" class="Symbol">{</a><a id="24477" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24477" class="Bound">Γ</a><a id="24478" class="Symbol">}{</a><a id="24480" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24480" class="Bound">M</a><a id="24481" class="Symbol">}{</a><a id="24483" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24483" class="Bound">N</a><a id="24484" class="Symbol">}</a> <a id="24486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24486" class="Bound">r</a> <a id="24488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24488" class="Bound">γ</a> <a id="24490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24490" class="Bound">v</a> <a id="24492" class="Symbol">=</a>
    <a id="24498" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="24500" class="Symbol">(λ</a> <a id="24503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24503" class="Bound">m</a> <a id="24505" class="Symbol">→</a> <a id="24507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#6771" class="Function">preserve</a> <a id="24516" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24503" class="Bound">m</a> <a id="24518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24486" class="Bound">r</a><a id="24519" class="Symbol">)</a> <a id="24521" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="24523" class="Symbol">(λ</a> <a id="24526" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24526" class="Bound">n</a> <a id="24528" class="Symbol">→</a> <a id="24530" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#23249" class="Function">reflect</a> <a id="24538" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24526" class="Bound">n</a> <a id="24540" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24486" class="Bound">r</a> <a id="24542" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="24546" class="Symbol">)</a> <a id="24548" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>{% endraw %}</pre>

We conclude with the _soundness property_, that multi-step reduction
to a lambda abstraction implies denotational equivalence with a lambda
abstraction.

<pre class="Agda">{% raw %}<a id="soundness"></a><a id="24729" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24729" class="Function">soundness</a> <a id="24739" class="Symbol">:</a> <a id="24741" class="Symbol">∀{</a><a id="24743" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24743" class="Bound">Γ</a><a id="24744" class="Symbol">}</a> <a id="24746" class="Symbol">{</a><a id="24747" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24747" class="Bound">M</a> <a id="24749" class="Symbol">:</a> <a id="24751" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24743" class="Bound">Γ</a> <a id="24753" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="24755" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="24756" class="Symbol">}</a> <a id="24758" class="Symbol">{</a><a id="24759" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24759" class="Bound">N</a> <a id="24761" class="Symbol">:</a> <a id="24763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24743" class="Bound">Γ</a> <a id="24765" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#3018" class="InductiveConstructor Operator">,</a> <a id="24767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a> <a id="24769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4150" class="Datatype Operator">⊢</a> <a id="24771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#2694" class="InductiveConstructor">★</a><a id="24772" class="Symbol">}</a>
  <a id="24776" class="Symbol">→</a> <a id="24778" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24747" class="Bound">M</a> <a id="24780" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#894" class="Datatype Operator">—↠</a> <a id="24783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="24785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24759" class="Bound">N</a>
    <a id="24791" class="Comment">-----------------</a>
  <a id="24811" class="Symbol">→</a> <a id="24813" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#17987" class="Function">ℰ</a> <a id="24815" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24747" class="Bound">M</a> <a id="24817" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18185" class="Function Operator">≃</a> <a id="24819" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#17987" class="Function">ℰ</a> <a id="24821" class="Symbol">(</a><a id="24822" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="InductiveConstructor Operator">ƛ</a> <a id="24824" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24759" class="Bound">N</a><a id="24825" class="Symbol">)</a>
<a id="24827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24729" class="Function">soundness</a> <a id="24837" class="Symbol">(</a><a id="24838" class="DottedPattern Symbol">.(</a><a id="24840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Untyped.md %}{% raw %}#4238" class="DottedPattern InductiveConstructor Operator">ƛ</a> <a id="24842" class="DottedPattern Symbol">_)</a> <a id="24845" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#944" class="InductiveConstructor Operator">[]</a><a id="24847" class="Symbol">)</a> <a id="24849" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24849" class="Bound">γ</a> <a id="24851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24851" class="Bound">v</a> <a id="24853" class="Symbol">=</a> <a id="24855" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟨</a> <a id="24857" class="Symbol">(λ</a> <a id="24860" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24860" class="Bound">x</a> <a id="24862" class="Symbol">→</a> <a id="24864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24860" class="Bound">x</a><a id="24865" class="Symbol">)</a> <a id="24867" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="24869" class="Symbol">(λ</a> <a id="24872" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24872" class="Bound">x</a> <a id="24874" class="Symbol">→</a> <a id="24876" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24872" class="Bound">x</a><a id="24877" class="Symbol">)</a> <a id="24879" href="https://agda.github.io/agda-stdlib/v0.17/Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">⟩</a>
<a id="24881" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24729" class="Function">soundness</a> <a id="24891" class="Symbol">{</a><a id="24892" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24892" class="Bound">Γ</a><a id="24893" class="Symbol">}</a> <a id="24895" class="Symbol">(</a><a id="24896" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24896" class="Bound">L</a> <a id="24898" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#1001" class="InductiveConstructor Operator">—→⟨</a> <a id="24902" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24902" class="Bound">r</a> <a id="24904" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/LambdaReduction.md %}{% raw %}#1001" class="InductiveConstructor Operator">⟩</a> <a id="24906" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24906" class="Bound">M—↠N</a><a id="24910" class="Symbol">)</a> <a id="24912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24912" class="Bound">γ</a> <a id="24914" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24914" class="Bound">v</a> <a id="24916" class="Symbol">=</a>
   <a id="24921" class="Keyword">let</a> <a id="24925" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24925" class="Bound">ih</a> <a id="24928" class="Symbol">=</a> <a id="24930" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24729" class="Function">soundness</a> <a id="24940" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24906" class="Bound">M—↠N</a> <a id="24945" class="Keyword">in</a>
   <a id="24951" class="Keyword">let</a> <a id="24955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24955" class="Bound">e</a> <a id="24957" class="Symbol">=</a> <a id="24959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24379" class="Function">reduce-equal</a> <a id="24972" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24902" class="Bound">r</a> <a id="24974" class="Keyword">in</a>
   <a id="24980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Denotational.md %}{% raw %}#18606" class="Function">≃-trans</a> <a id="24988" class="Symbol">{</a><a id="24989" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24892" class="Bound">Γ</a><a id="24990" class="Symbol">}</a> <a id="24992" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24955" class="Bound">e</a> <a id="24994" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24925" class="Bound">ih</a> <a id="24997" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24912" class="Bound">γ</a> <a id="24999" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/Soundness.md %}{% raw %}#24914" class="Bound">v</a>{% endraw %}</pre>


## Unicode

This chapter uses the following unicode:

    ≟  U+225F  QUESTIONED EQUAL TO (\?=)
